# SMS 인증 시스템 설정 가이드

Attract 앱의 회원가입 시 SMS 인증 시스템을 사용하기 위한 설정 가이드입니다.

## 📱 사용 API

이 프로젝트는 **쏘다(ssodaa.com)** SMS API를 사용합니다.

- 공식 사이트: https://ssodaa.com
- API 문서: https://ssodaa.com/service/api/smsapi

## 🔧 설정 방법

### 1. 쏘다 회원가입 및 API 키 발급

1. https://ssodaa.com 접속
2. 회원가입 진행
3. 로그인 후 **[API 토큰 관리]** 메뉴 접속
4. **API 키 발급** 클릭
   - `token_key`: 회원 토큰
   - `api_key`: API 인증 키

### 2. 발신번호 등록

SMS 발송을 위해서는 **반드시 발신번호를 등록**해야 합니다.

1. 쏘다 대시보드에서 **[발신번호 관리]** 메뉴 접속
2. **발신번호 등록** 클릭
3. 발신번호 입력 및 인증 방식 선택
   - 휴대전화 본인인증
   - 서류인증 (사업자등록증 등)
4. 인증 완료 후 승인 대기
5. 승인 완료된 발신번호를 메모

### 3. 환경 변수 설정

프로젝트 루트 디렉토리에 `.env` 파일을 생성하고 다음 내용을 추가합니다:

```bash
# 쏘다 SMS API Configuration
VITE_SSODAA_API_KEY=발급받은_api_key
VITE_SSODAA_TOKEN_KEY=발급받은_token_key
VITE_SSODAA_SEND_PHONE=등록된_발신번호 (예: 01012345678)
```

**주의사항:**
- 발신번호는 하이픈(-) 없이 숫자만 입력
- API 키는 절대 공개 저장소에 커밋하지 말 것
- `.env` 파일은 `.gitignore`에 포함되어 있음

### 4. 포인트 충전

SMS 발송을 위해서는 **포인트 충전**이 필요합니다.

1. 쏘다 대시보드에서 **[충전하기]** 메뉴 접속
2. 원하는 금액 선택 및 결제
3. 충전 완료 후 잔여 포인트 확인

**SMS 발송 비용:**
- 단문 SMS (80byte 이하): 약 10~15원/건
- 장문 LMS (2000byte 이하): 약 30~40원/건

### 5. 개발 서버 실행

```bash
npm run dev
```

## 📝 SMS 인증 흐름

1. **사용자가 전화번호 입력**
   - 형식: 010-1234-5678 (자동 하이픈 추가)

2. **"인증번호" 버튼 클릭**
   - 6자리 랜덤 인증번호 생성
   - 쏘다 API를 통해 SMS 발송
   - 3분 타이머 시작

3. **인증번호 입력**
   - 사용자가 받은 6자리 번호 입력
   - "확인" 버튼 클릭

4. **인증 확인**
   - 입력한 번호와 발송한 번호 비교
   - 일치 시 인증 완료 표시
   - 회원가입 진행 가능

5. **타이머 만료 시**
   - 3분 경과 시 재발송 가능
   - "재발송" 버튼으로 새 인증번호 발송

## 🔍 문제 해결

### API 키 오류

**증상:** "SMS 설정이 올바르지 않습니다" 에러

**해결:**
1. `.env` 파일에 API 키가 올바르게 설정되었는지 확인
2. 환경 변수 이름이 정확한지 확인 (`VITE_` 접두사 포함)
3. 개발 서버 재시작 (`npm run dev`)

### 발신번호 오류

**증상:** SMS 발송 실패, "발신번호가 등록되지 않음" 에러

**해결:**
1. 쏘다 대시보드에서 발신번호 승인 상태 확인
2. `.env`의 발신번호가 등록된 번호와 일치하는지 확인
3. 발신번호 형식 확인 (하이픈 제거, 숫자만)

### 포인트 부족

**증상:** SMS 발송 실패, "포인트 부족" 에러

**해결:**
1. 쏘다 대시보드에서 잔여 포인트 확인
2. 포인트 충전 진행

### SMS가 도착하지 않음

**증상:** 발송 성공했으나 문자가 오지 않음

**해결:**
1. 수신 전화번호가 정확한지 확인
2. 스팸 차단 앱 확인
3. 통신사 스팸 필터 확인
4. 쏘다 대시보드에서 발송 내역 확인

## 🛠️ API 테스트

포인트 조회 테스트:

```typescript
import { getRemainingPoints } from './services/smsService';

const testPoints = async () => {
  const result = await getRemainingPoints();
  console.log('잔여 포인트:', result);
};
```

SMS 발송 테스트:

```typescript
import { sendSMS } from './services/smsService';

const testSMS = async () => {
  const result = await sendSMS('010-1234-5678', '테스트 메시지입니다.');
  console.log('발송 결과:', result);
};
```

## 📚 관련 파일

- **서비스 파일**: `src/services/smsService.ts`
- **회원가입 페이지**: `src/pages/signup/QuickSignupPage.tsx`
- **환경 변수 예제**: `.env.example`

## 💰 비용 관리

- **개발/테스트 시**: 적은 금액(1만원)으로 테스트
- **프로덕션 배포 시**: 예상 사용량 계산 후 충전
- **자동 충전 설정**: 쏘다에서 자동 충전 설정 가능

**예상 사용량 계산:**
- 일 회원가입 100명 예상
- SMS 단문 기준 15원/건
- 일 비용: 100 × 15 = 1,500원
- 월 비용: 1,500 × 30 = 45,000원

## 🔐 보안 주의사항

1. **API 키 보안**
   - `.env` 파일을 절대 커밋하지 말 것
   - 공개 저장소에 API 키 노출 금지
   - 프로덕션과 개발 환경 API 키 분리

2. **발송 제한**
   - 동일 번호로 과도한 발송 제한 (rate limiting 고려)
   - 인증번호 재발송은 최소 30초 간격 권장

3. **인증번호 보안**
   - 6자리 랜덤 숫자 사용
   - 3분 유효시간 설정
   - 인증 완료 후 즉시 폐기

## 📞 지원

- 쏘다 고객센터: 1688-4221
- 이메일: ssodaa@webmaker21.net
- API 문서: https://ssodaa.com/service/api/smsapi

import{u as e,f as t,j as s,l as a,q as r,w as i,c as l,o as n,d as o,e as c,i as d,k as m,m as x,n as h}from"./index-CkhljOBK.js";import{u,r as p,a as f}from"./vendor-Dma7sgzX.js";function g({coins:a=0}){const r=u(),{user:i}=e(),[l,n]=p.useState(!1),[o,c]=p.useState(0);p.useEffect(()=>{if(!i?.id)return;d();const e=setInterval(d,3e4);return()=>clearInterval(e)},[i?.id]);const d=async()=>{try{if(!i?.id)return void c(0);const{notifications:e,error:s}=await t.notifications.getUserNotifications(i.id);if(!s&&e){const t=e.filter(e=>!e.read);c(t.length)}}catch(e){}};return s.jsxs(s.Fragment,{children:[s.jsx("header",{className:"fixed top-0 left-1/2 -translate-x-1/2 w-full max-w-[400px] glass z-50 transition-all duration-300",style:{paddingTop:"env(safe-area-inset-top)"},children:s.jsxs("div",{className:"flex items-center justify-between px-4 py-1 h-14",children:[s.jsx("div",{className:"flex items-center cursor-pointer",onClick:()=>r("/"),children:s.jsxs("h1",{className:"flex items-center space-x-1 group",children:[s.jsx("div",{className:"relative transform transition-transform group-hover:scale-110 duration-300 -my-2",children:s.jsx("img",{src:"/image/icon.png",alt:"Attract ë§ˆìŠ¤ì½”íŠ¸",className:"w-14 h-14 object-contain drop-shadow-md"})}),s.jsx("span",{className:"text-xl font-bold font-display bg-gradient-to-r from-primary-600 to-secondary-600 bg-clip-text text-transparent tracking-tight",children:"Attract"})]})}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{onClick:()=>r("/coin-shop"),className:"group flex items-center gap-1 bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-2 py-1 rounded-full hover:from-blue-600 hover:to-cyan-600 transition-all duration-300 shadow-lg shadow-blue-500/30 hover:shadow-blue-500/50 transform hover:-translate-y-0.5",children:[s.jsx("img",{src:"/image/magnet.png",alt:"ìžì„",className:"w-8 h-8 object-contain group-hover:rotate-12 transition-transform"}),s.jsx("span",{className:"text-sm font-bold font-display pr-1",children:a.toLocaleString()})]}),s.jsxs("button",{onClick:()=>r("/notifications"),className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-slate-100 transition-colors relative group",children:[s.jsx("i",{className:"ri-notification-line text-slate-600 text-xl group-hover:text-primary-600 transition-colors"}),o>0&&s.jsx("span",{className:"absolute -top-0.5 -right-0.5 bg-red-500 text-white text-[10px] font-bold rounded-full min-w-[18px] h-[18px] flex items-center justify-center px-1 border-2 border-white shadow-sm animate-pulse",children:o>9?"9+":o})]}),s.jsx("button",{onClick:()=>n(!l),className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-slate-100 transition-colors group",children:s.jsx("i",{className:`ri-menu-line text-slate-600 text-xl group-hover:text-primary-600 transition-colors ${l?"rotate-90":""} duration-300`})})]})]})}),l&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-slate-900/20 backdrop-blur-sm z-40 animate-fade-in",onClick:()=>n(!1)}),s.jsxs("div",{className:"fixed top-20 right-4 bg-white/90 backdrop-blur-xl rounded-2xl shadow-2xl py-2 w-56 z-50 animate-slide-up border border-white/20",children:[s.jsxs("div",{className:"px-4 py-3 border-b border-slate-100",children:[s.jsx("p",{className:"text-sm text-slate-500",children:"í™˜ì˜í•©ë‹ˆë‹¤!"}),s.jsxs("p",{className:"font-bold text-slate-800",children:[i?.name||"ì‚¬ìš©ìž","ë‹˜"]})]}),s.jsx("div",{className:"py-2",children:[{icon:"ri-user-line",label:"ë§ˆì´íŽ˜ì´ì§€",action:()=>{n(!1),r("/"),setTimeout(()=>{const e=new CustomEvent("switchTab",{detail:{tab:"profile"}});window.dispatchEvent(e)},100)}},{icon:"ri-settings-line",label:"ì„¤ì •",action:()=>{n(!1),r("/settings")}},{icon:"ri-question-line",label:"FAQ",action:()=>{n(!1),r("/faq")}},{icon:"ri-customer-service-line",label:"1:1ë¬¸ì˜",action:()=>{n(!1),r("/support")}}].map((e,t)=>s.jsxs("button",{onClick:e.action,className:"w-full text-left px-4 py-2.5 hover:bg-primary-50 text-slate-600 hover:text-primary-600 transition-colors flex items-center space-x-3 group",children:[s.jsx("i",{className:`${e.icon} text-lg group-hover:scale-110 transition-transform`}),s.jsx("span",{className:"font-medium",children:e.label})]},t))}),s.jsx("div",{className:"border-t border-slate-100 mt-1 pt-1",children:s.jsxs("button",{onClick:()=>{localStorage.removeItem("auth_user"),localStorage.removeItem("isLoggedIn"),localStorage.removeItem("userEmail"),localStorage.removeItem("user_id"),localStorage.removeItem("user_data"),window.location.href="/login"},className:"w-full text-left px-4 py-2.5 hover:bg-red-50 text-red-500 hover:text-red-600 transition-colors flex items-center space-x-3 group",children:[s.jsx("i",{className:"ri-logout-box-line text-lg group-hover:scale-110 transition-transform"}),s.jsx("span",{className:"font-medium",children:"ë¡œê·¸ì•„ì›ƒ"})]})})]})]})]})}function b({activeTab:e,onTabChange:t}){return s.jsx("div",{className:"fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-[400px] z-50 bg-white border-t border-gray-200",style:{paddingBottom:"env(safe-area-inset-bottom)"},children:s.jsx("div",{className:"flex items-center justify-around py-2",children:[{id:"matching",icon:"ri-heart-3-line",activeIcon:"ri-heart-3-fill",label:"ë§¤ì¹­"},{id:"community",icon:"ri-group-line",activeIcon:"ri-group-fill",label:"ì»¤ë®¤ë‹ˆí‹°"},{id:"chat",icon:"ri-chat-3-line",activeIcon:"ri-chat-3-fill",label:"ì±„íŒ…"},{id:"profile",icon:"ri-user-line",activeIcon:"ri-user-fill",label:"My"}].map(a=>{const r=e===a.id;return s.jsxs("button",{onClick:()=>t(a.id),className:"flex flex-col items-center justify-center flex-1 py-2 "+(r?"text-primary-600":"text-gray-400"),children:[s.jsx("i",{className:`text-2xl ${r?a.activeIcon:a.icon}`}),s.jsx("span",{className:"text-[10px] font-medium mt-1",children:a.label})]},a.id)})})})}function j(){return s.jsxs("div",{className:"bg-white rounded-3xl overflow-hidden shadow-lg",children:[s.jsx("div",{className:"aspect-[3/4] bg-slate-200 animate-pulse"}),s.jsxs("div",{className:"p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"h-6 w-24 bg-slate-200 rounded animate-pulse"}),s.jsx("div",{className:"h-5 w-12 bg-slate-200 rounded-full animate-pulse"})]}),s.jsx("div",{className:"h-4 w-32 bg-slate-200 rounded animate-pulse"}),s.jsx("div",{className:"h-4 w-40 bg-slate-200 rounded animate-pulse"})]})]})}function v(){return s.jsx("div",{className:"grid grid-cols-2 gap-3 px-3 py-4",children:[...Array(4)].map((e,t)=>s.jsx(j,{},t))})}function y(){return s.jsxs("div",{className:"bg-white rounded-2xl p-4 shadow-sm",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-slate-200 animate-pulse"}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx("div",{className:"h-4 w-20 bg-slate-200 rounded animate-pulse"}),s.jsx("div",{className:"h-3 w-32 bg-slate-200 rounded animate-pulse"})]}),s.jsx("div",{className:"w-12 h-12 rounded-xl bg-slate-200 animate-pulse"})]}),s.jsxs("div",{className:"mt-3 space-y-2",children:[s.jsx("div",{className:"h-4 w-full bg-slate-200 rounded animate-pulse"}),s.jsx("div",{className:"h-4 w-3/4 bg-slate-200 rounded animate-pulse"})]})]})}function w(){return s.jsx("div",{className:"space-y-3 px-4",children:[...Array(5)].map((e,t)=>s.jsx(y,{},t))})}function N({src:e,alt:t,className:a="",placeholderColor:r="bg-slate-200",...i}){const[l,n]=p.useState(!1),[o,c]=p.useState(!1),[d,m]=p.useState(!1),x=p.useRef(null);p.useEffect(()=>{const e=new IntersectionObserver(([t])=>{t.isIntersecting&&(c(!0),e.disconnect())},{rootMargin:"100px",threshold:.1});return x.current&&e.observe(x.current),()=>e.disconnect()},[]);return s.jsxs("div",{ref:x,className:`relative overflow-hidden ${a}`,children:[!l&&s.jsx("div",{className:`absolute inset-0 ${r} animate-pulse`,children:s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("i",{className:"ri-image-line text-slate-300 text-3xl"})})}),o&&!d&&s.jsx("img",{src:e,alt:t,onLoad:()=>{n(!0)},onError:()=>{m(!0),n(!0)},className:"w-full h-full object-cover object-top transition-opacity duration-300 "+(l?"opacity-100":"opacity-0"),...i}),d&&s.jsx("div",{className:`absolute inset-0 ${r} flex items-center justify-center`,children:s.jsx("i",{className:"ri-user-line text-slate-400 text-4xl"})})]})}let k={male:[],female:[]},C={male:0,female:0};function _(){const a=u(),{user:r}=e(),[i,l]=p.useState(""),[n,o]=p.useState(!1),[c,d]=p.useState(!0),[m,x]=p.useState([]),[h,f]=p.useState(0),[g,b]=p.useState(!0),[j,y]=p.useState(null),w=p.useRef(!1),[_,S]=p.useState(""),[I,D]=p.useState("ì „ì²´");p.useEffect(()=>(document.body.style.overflow=n?"hidden":"",()=>{document.body.style.overflow=""}),[n]),p.useEffect(()=>{(async()=>{if(r?.id)try{const{user:e}=await t.users.getUserById(r.id);e?.gender&&("male"===e.gender?l("female"):"female"===e.gender&&l("male"))}catch(e){}})()},[r?.id]),p.useEffect(()=>{if(!i)return;const e=i,t=Date.now();k[e].length>0&&t-C[e]<3e5?(x(k[e]),d(!1)):w.current||E()},[i]);const E=async(e=!1)=>{if(i&&(!w.current||e)){w.current=!0,d(!0);try{const s=e?h+1:0,{users:a,error:l,lastDoc:n}=await t.users.getUsersByGender(i,r?.id,20,e?j:void 0);if(l)throw l;if(a){const t=a.filter(e=>!!(e.avatar_url||e.profile_image)).map(e=>{const t=e.avatar_url||e.profile_image||"",s=[];return t&&s.push(t),e.photos&&Array.isArray(e.photos)&&e.photos.forEach(e=>{e&&!s.includes(e)&&s.push(e)}),{id:e.id,name:e.name||"ì•Œ ìˆ˜ ì—†ìŒ",age:e.age||20,gender:e.gender||"ë¬´ê´€",location:e.location||"ìœ„ì¹˜ ë¯¸ì„¤ì •",school:e.school||"í•™êµ ë¯¸ì„¤ì •",mbti:e.mbti||"",character:t,bio:e.bio||"ìžê¸°ì†Œê°œê°€ ì—†ìŠµë‹ˆë‹¤.",hasLikedMe:!1,photos:s,profile_image:t,height:e.height||"",body_type:e.body_type||"",bodyType:e.body_type||"",style:e.style||"",religion:e.religion||"",smoking:e.smoking||"",drinking:e.drinking||"",interests:e.interests||[]}});e?x(e=>[...e,...t]):(x(t),"male"!==i&&"female"!==i||(k[i]=t,C[i]=Date.now())),y(n),f(s),b(t.length>=20)}}catch(s){e||x([])}finally{d(!1),w.current=!1}}},T=p.useMemo(()=>m.filter(e=>e.gender===i),[m,i]);return c?s.jsxs("div",{className:"min-h-screen bg-slate-50 pt-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4 px-3",children:[s.jsx("div",{className:"h-7 w-16 bg-slate-200 rounded animate-pulse"}),s.jsx("div",{className:"h-10 w-10 bg-slate-200 rounded-full animate-pulse"})]}),s.jsx(v,{})]}):0===T.length?s.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-slate-50 space-y-4 px-4",children:[s.jsx("i",{className:"ri-search-line text-6xl text-slate-300"}),s.jsx("p",{className:"text-center text-slate-600 font-medium",children:"ì¡°ê±´ì— ë§žëŠ” í”„ë¡œí•„ì´ ì—†ìŠµë‹ˆë‹¤"})]}):s.jsxs("div",{className:"px-3 pt-2 pb-4 min-h-screen",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"ë§¤ì¹­"}),s.jsx("div",{className:"flex items-center space-x-2",children:s.jsx("button",{onClick:()=>{S(i),o(!n)},className:"w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-md cursor-pointer hover:shadow-lg transition-all hover:scale-105 group",children:s.jsx("i",{className:"ri-filter-line text-slate-400 group-hover:text-primary-500 text-lg transition-colors"})})})]}),s.jsx("div",{className:"grid grid-cols-2 gap-3",children:T.map(e=>s.jsxs("div",{onClick:()=>(e=>{const t={...e,bodyType:e.body_type||e.bodyType};a("/profile-detail",{state:{profile:t}})})(e),className:"bg-white rounded-2xl shadow-lg overflow-hidden cursor-pointer hover:shadow-2xl hover:shadow-primary-500/10 transition-all duration-300 relative group transform hover:-translate-y-1",children:[e.hasLikedMe&&s.jsx("div",{className:"absolute top-3 right-3 w-7 h-7 bg-gradient-to-br from-pink-500 to-rose-500 rounded-full flex items-center justify-center z-10 shadow-lg shadow-pink-500/30 animate-pulse-soft",children:s.jsx("i",{className:"ri-heart-fill text-white text-xs"})}),s.jsxs("div",{className:"absolute top-3 left-3 z-10 flex items-center space-x-1.5",children:[s.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center shadow-md "+("female"===e.gender?"bg-gradient-to-br from-pink-400 to-pink-500":"bg-gradient-to-br from-blue-400 to-blue-500"),children:s.jsx("i",{className:"text-xs text-white "+("female"===e.gender?"ri-women-line":"ri-men-line")})}),s.jsx("span",{className:"bg-white/95 text-slate-700 px-2.5 py-1 rounded-full text-[10px] font-bold shadow-md",children:e.mbti||"MBTI"})]}),s.jsxs("div",{className:"relative aspect-[3/4] overflow-hidden bg-slate-100",children:[s.jsx(N,{src:e.character,alt:e.name,className:"w-full h-full"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900/90 via-slate-900/30 to-transparent opacity-80"}),s.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-3 text-white",children:[s.jsx("h3",{className:"font-bold text-base mb-0.5 truncate",children:e.name}),s.jsxs("div",{className:"flex items-center text-xs text-slate-200 space-x-1",children:[s.jsxs("span",{children:[e.age,"ì„¸"]}),s.jsx("span",{children:"Â·"}),s.jsx("span",{className:"truncate",children:e.location})]}),s.jsxs("div",{className:"flex items-center text-[10px] mt-1.5 text-slate-300 bg-white/10 rounded px-1.5 py-0.5 w-fit backdrop-blur-sm",children:[s.jsx("i",{className:"ri-school-line mr-1"}),s.jsx("span",{className:"truncate max-w-[80px]",children:e.school})]})]})]})]},e.id))}),g&&s.jsx("div",{className:"mt-10 text-center pb-8",children:s.jsx("button",{onClick:()=>E(!0),disabled:c,className:"bg-white text-slate-600 px-8 py-3 rounded-full font-bold shadow-lg hover:shadow-xl hover:text-primary-600 hover:scale-105 transition-all cursor-pointer whitespace-nowrap flex items-center mx-auto space-x-2 disabled:opacity-50",children:c?s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),s.jsx("span",{children:"ë¡œë”© ì¤‘..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{children:"ì¹œêµ¬ ë”ë³´ê¸°"}),s.jsx("i",{className:"ri-arrow-down-s-line"})]})})}),n&&s.jsxs("div",{className:"fixed inset-0 z-50 flex justify-center",onClick:()=>o(!1),children:[s.jsx("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm animate-fade-in"}),s.jsx("div",{className:"relative w-full max-w-[400px] flex items-start justify-center pt-20",children:s.jsxs("div",{className:"bg-white w-[90%] rounded-3xl p-6 max-h-[70vh] overflow-y-auto shadow-2xl overscroll-contain touch-pan-y animate-slide-up",style:{WebkitOverflowScrolling:"touch"},onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h3",{className:"text-xl font-bold font-display text-slate-800",children:"í•„í„°"}),s.jsx("button",{onClick:()=>o(!1),className:"w-10 h-10 flex items-center justify-center cursor-pointer hover:bg-slate-100 rounded-full transition-colors",children:s.jsx("i",{className:"ri-close-line text-2xl text-slate-400"})})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-slate-800 mb-3 text-base",children:"ì„±ë³„"}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:()=>S("female"),className:"flex-1 py-3 rounded-xl font-bold transition-all cursor-pointer border-2 "+("female"===_?"border-primary-500 bg-primary-50 text-primary-600":"border-slate-100 bg-white text-slate-400 hover:border-slate-200"),children:"ì—¬ìž"}),s.jsx("button",{onClick:()=>S("male"),className:"flex-1 py-3 rounded-xl font-bold transition-all cursor-pointer border-2 "+("male"===_?"border-primary-500 bg-primary-50 text-primary-600":"border-slate-100 bg-white text-slate-400 hover:border-slate-200"),children:"ë‚¨ìž"})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-slate-800 mb-3 text-base",children:"ì§€ì—­"}),s.jsx("div",{className:"grid grid-cols-3 gap-2",children:["ì „ì²´","ì¸ì²œ/ì„œìš¸","ê²½ê¸°/ê°•ì›","ê²½ìƒê¶Œ","ì¶©ì²­ê¶Œ","í˜¸ë‚¨ê¶Œ"].map(e=>s.jsx("button",{onClick:()=>D(e),className:"px-2 py-2.5 rounded-xl text-sm font-medium transition-colors cursor-pointer whitespace-nowrap border "+(I===e?"border-primary-500 bg-primary-50 text-primary-600":"border-slate-100 bg-slate-50 text-slate-600 hover:bg-primary-50 hover:text-primary-600"),children:e},e))})]})]}),s.jsxs("div",{className:"flex space-x-3 mt-8",children:[s.jsx("button",{onClick:()=>{S(i),D("ì „ì²´"),o(!1)},className:"flex-1 py-3 bg-slate-100 text-slate-600 rounded-xl font-bold cursor-pointer hover:bg-slate-200 transition-colors",children:"ë‹«ê¸°"}),s.jsx("button",{onClick:()=>{l(_),o(!1),k={male:[],female:[]},C={male:0,female:0},x([]),f(0),b(!0)},className:"flex-1 py-3 bg-gradient-to-r from-primary-500 to-primary-600 text-white rounded-xl font-bold cursor-pointer shadow-lg shadow-primary-500/30 hover:shadow-primary-500/50 transition-all",children:"ì ìš©í•˜ê¸°"})]})]})})]})]})}function S({post:r,onBack:i,onUpdatePost:l,onDeletePost:n}){const o=u(),{user:c}=e(),[d,m]=p.useState(r),[x,h]=p.useState(""),[f,g]=p.useState(!1),[b,j]=p.useState(!1);p.useEffect(()=>{window.scrollTo(0,0),v()},[r.id]);const v=async()=>{j(!0);try{const{comments:e,error:s}=await t.posts.getComments(r.id);if(s)throw s;if(e){const t=e.map(e=>({id:e.id,author:e.author_name,avatar:e.avatar_url||"https://via.placeholder.com/100",content:e.content,timeAgo:y(e.created_at?.toDate?.()?.toISOString()||e.created_at||(new Date).toISOString()),likes:e.likes||0,isLiked:!1}));m(e=>({...e,comments:t}))}}catch(e){a.error("ëŒ“ê¸€ ë¡œë“œ ì‹¤íŒ¨",e)}finally{j(!1)}},y=e=>{const t=new Date,s=new Date(e),a=Math.floor((t.getTime()-s.getTime())/6e4);if(a<1)return"ë°©ê¸ˆ ì „";if(a<60)return`${a}ë¶„ ì „`;const r=Math.floor(a/60);if(r<24)return`${r}ì‹œê°„ ì „`;return`${Math.floor(r/24)}ì¼ ì „`},w=async()=>{if(x.trim())if(c)try{const{comment:e,error:s}=await t.posts.createComment(d.id,c.id,x,c);if(s)throw s;if(e){const t={id:e.id,author:e.author_name,avatar:e.avatar_url||"https://via.placeholder.com/100",content:e.content,timeAgo:"ë°©ê¸ˆ ì „",likes:0,isLiked:!1},s={...d,comments:[...d.comments,t]};m(s),l(s),h("")}}catch(e){a.error("ëŒ“ê¸€ ìž‘ì„± ì˜¤ë¥˜",e),alert("ëŒ“ê¸€ ìž‘ì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}else alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.")};return s.jsxs("div",{className:"min-h-screen bg-white pb-32",children:[s.jsxs("div",{className:"sticky top-0 z-40 bg-white flex items-center px-4 h-14 border-b border-gray-100",children:[s.jsx("button",{onClick:i,className:"mr-4",children:s.jsx("i",{className:"ri-arrow-left-line text-2xl text-gray-800"})}),s.jsx("h1",{className:"text-lg font-bold text-gray-800 flex-1 text-center mr-8",children:"ê²Œì‹œê¸€"})]}),s.jsxs("div",{className:"bg-white",children:[s.jsxs("div",{className:"px-4 py-4",children:[s.jsxs("div",{className:"flex items-center mb-3",children:[s.jsx("img",{src:d.avatar,alt:d.author,className:"w-10 h-10 rounded-full object-cover mr-3 flex-shrink-0 border border-gray-100 cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>{if(d.userId!==c?.id)if(d.authorData){const e=d.authorData.avatar_url||d.authorData.profile_image;o("/profile-detail",{state:{profile:{id:d.authorData.id,name:d.authorData.name,age:d.authorData.age,gender:d.authorData.gender,location:d.authorData.location,school:d.authorData.school,mbti:d.authorData.mbti,bio:d.authorData.bio,photos:e?[e]:[],interests:d.authorData.interests||[],height:d.authorData.height,bodyType:d.authorData.body_type,religion:d.authorData.religion,smoking:d.authorData.smoking,drinking:d.authorData.drinking}}})}else d.userId&&(async e=>{try{const{user:s,error:a}=await t.users.getUserById(e);if(a)throw a;s&&o("/profile-detail",{state:{profile:{id:s.id,name:s.name,age:s.age,gender:s.gender,location:s.location,school:s.school||s.job,mbti:s.mbti,bio:s.bio,photos:s.profile_image?[s.profile_image]:s.avatar_url?[s.avatar_url]:[],interests:s.interests||[],height:s.height,bodyType:s.body_type,religion:s.religion,smoking:s.smoking,drinking:s.drinking}}})}catch(s){a.error("í”„ë¡œí•„ ë¡œë“œ ì‹¤íŒ¨",s),alert("í”„ë¡œí•„ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}})(d.userId);else o("/my-profile")}}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"font-bold text-gray-900 text-sm truncate",children:d.author}),s.jsx("div",{className:"text-xs text-gray-400 mt-0.5",children:d.timeAgo})]}),d.userId===c?.id&&s.jsx("button",{onClick:async()=>{if(d.userId===c?.id){if(window.confirm("ê²Œì‹œê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")){g(!0);try{const{error:e}=await t.posts.deletePost(d.id);if(e)throw e;n&&n(d.id),alert("ê²Œì‹œê¸€ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."),i()}catch(e){a.error("ê²Œì‹œê¸€ ì‚­ì œ ì˜¤ë¥˜",e),alert("ê²Œì‹œê¸€ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{g(!1)}}}else alert("ìžì‹ ì˜ ê²Œì‹œê¸€ë§Œ ì‚­ì œí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.")},disabled:f,className:"text-gray-400 p-2 -mr-2",children:s.jsx("i",{className:`ri-${f?"loader-4-line animate-spin":"more-fill"} text-xl`})})]}),s.jsx("p",{className:"text-sm text-gray-800 whitespace-pre-wrap leading-relaxed",children:d.content})]}),d.image&&s.jsx("div",{className:"w-full mb-2",children:s.jsx("img",{src:d.image,alt:"ê²Œì‹œê¸€ ì´ë¯¸ì§€",className:"w-full h-auto object-cover"})}),s.jsxs("div",{className:"px-4 py-3 flex items-center gap-4 border-b border-gray-50",children:[s.jsxs("button",{onClick:async()=>{const e=d.isLiked?d.likes-1:d.likes+1,s={...d,isLiked:!d.isLiked,likes:e};m(s),l(s);try{d.isLiked?await t.posts.unlikePost(d.id):await t.posts.likePost(d.id)}catch(r){a.error("ì¢‹ì•„ìš” ì—…ë°ì´íŠ¸ ì˜¤ë¥˜",r)}},className:"flex items-center gap-1.5 transition-colors",children:[s.jsx("i",{className:(d.isLiked?"ri-heart-fill text-pink-500":"ri-heart-line text-gray-400")+" text-xl"}),s.jsx("span",{className:"text-sm text-gray-600",children:d.likes})]}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("i",{className:"ri-chat-3-line text-xl text-gray-400"}),s.jsx("span",{className:"text-sm text-gray-600",children:"ëŒ“ê¸€"})]})]})]}),s.jsxs("div",{className:"px-4 py-4",children:[s.jsxs("div",{className:"font-bold text-sm mb-4",children:["ëŒ“ê¸€ ",d.comments.length]}),b?s.jsx("div",{className:"flex justify-center py-8",children:s.jsx("i",{className:"ri-loader-4-line animate-spin text-2xl text-primary-500"})}):0===d.comments.length?s.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-gray-300",children:[s.jsx("i",{className:"ri-chat-3-line text-4xl mb-2 opacity-50"}),s.jsx("p",{className:"text-sm",children:"ì²« ë²ˆì§¸ ëŒ“ê¸€ì„ ë‚¨ê²¨ë³´ì„¸ìš”!"})]}):s.jsx("div",{className:"space-y-5",children:d.comments.map(e=>s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("img",{src:e.avatar,alt:e.author,className:"w-8 h-8 rounded-full object-cover flex-shrink-0 border border-gray-100"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"text-sm font-bold text-gray-900",children:e.author}),s.jsx("span",{className:"text-xs text-gray-400",children:e.timeAgo})]}),s.jsx("p",{className:"text-sm text-gray-700 leading-relaxed break-words",children:e.content}),s.jsxs("button",{onClick:()=>(async e=>{const s=d.comments.find(t=>t.id===e);if(!s)return;const r=s.isLiked?s.likes-1:s.likes+1,i={...d,comments:d.comments.map(t=>t.id===e?{...t,isLiked:!t.isLiked,likes:r}:t)};m(i),l(i);try{s.isLiked?await t.posts.unlikeComment(d.id,e):await t.posts.likeComment(d.id,e)}catch(n){a.error("ëŒ“ê¸€ ì¢‹ì•„ìš” ì—…ë°ì´íŠ¸ ì˜¤ë¥˜",n)}})(e.id),className:"text-xs mt-1.5 flex items-center gap-1 "+(e.isLiked?"text-pink-500":"text-gray-400"),children:[s.jsx("i",{className:e.isLiked?"ri-heart-fill":"ri-heart-line"}),s.jsxs("span",{children:["ì¢‹ì•„ìš” ",e.likes>0&&e.likes]})]})]})]},e.id))})]}),s.jsxs("div",{className:"fixed left-1/2 -translate-x-1/2 w-full max-w-[400px] bg-white border-t border-gray-100 px-4 py-3 flex items-center gap-3 z-40",style:{bottom:"calc(80px + env(safe-area-inset-bottom, 0px))"},children:[s.jsx("img",{src:c?.profile_image||"https://via.placeholder.com/100",alt:"ë‚´ í”„ë¡œí•„",className:"w-8 h-8 rounded-full object-cover border border-gray-100 flex-shrink-0"}),s.jsxs("div",{className:"flex-1 relative",children:[s.jsx("input",{value:x,onChange:e=>h(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),w())},placeholder:"ëŒ“ê¸€ì„ ìž…ë ¥í•˜ì„¸ìš”...",className:"w-full bg-gray-100 rounded-full pl-4 pr-10 py-2.5 text-sm focus:outline-none focus:ring-1 focus:ring-gray-200 transition-shadow"}),s.jsx("button",{onClick:w,disabled:!x.trim(),className:"absolute right-1.5 top-1/2 -translate-y-1/2 w-8 h-8 flex items-center justify-center rounded-full transition-colors "+(x.trim()?"text-primary-500 hover:bg-gray-200":"text-gray-300"),children:s.jsx("i",{className:"ri-send-plane-fill text-lg"})})]})]})]})}let I=null,D=0;function E(){const e=u(),[a,r]=p.useState("dating"),[i,l]=p.useState(I||[]),[n,o]=p.useState(""),[c,d]=p.useState(!1),[m,x]=p.useState(null),[h,f]=p.useState(!I),[g,b]=p.useState(void 0),[j,v]=p.useState(!1),[y,N]=p.useState("latest"),k=p.useRef(!1);p.useEffect(()=>{(async()=>{try{const s=localStorage.getItem("auth_user");if(s)try{const e=JSON.parse(s),{user:a}=await t.users.getUserById(e.id);return void b(a||e)}catch(e){}b(null)}catch(e){b(null)}})()},[]),p.useEffect(()=>{const e=Date.now();I&&e-D<3e5?(l(I),f(!1)):k.current||C()},[]);const C=async()=>{if(!k.current){k.current=!0,f(!0);try{const{posts:e,error:s}=await t.posts.getPosts(50);if(s)throw s;if(e&&e.length>0){const s=[...new Set(e.map(e=>e.user_id).filter(Boolean))];let a={};s.length>0&&await Promise.all(s.map(async e=>{const{user:s}=await t.users.getUserById(e);s&&(a[e]=s)}));const r=await Promise.all(e.map(async e=>{const t=a[e.user_id],s=t?.name||e.author_name||"ìµëª…",r=t?.profile_image||t?.avatar_url||e.avatar_url||"https://via.placeholder.com/100";return{id:e.id,author:s,avatar:r,content:e.content,image:e.image_url||e.images&&e.images[0],likes:e.likes||0,comments:[],commentsCount:e.comments_count||0,timeAgo:_(e.created_at?.toDate?.()?.toISOString()||e.created_at||(new Date).toISOString()),isLiked:!1,age:t?.age||e.age,location:t?.location||e.location,job:t?.school||t?.job||e.job,views:e.views||0,category:e.category||"dating",userId:e.user_id,authorData:t}}));l(r),I=r,D=Date.now()}else l([])}catch(e){l([])}finally{f(!1),k.current=!1}}},_=e=>{const t=new Date,s=new Date(e),a=Math.floor((t.getTime()-s.getTime())/6e4);if(a<1)return"ë°©ê¸ˆ ì „";if(a<60)return`${a}ë¶„ ì „`;const r=Math.floor(a/60);if(r<24)return`${r}ì‹œê°„ ì „`;return`${Math.floor(r/24)}ì¼ ì „`},E=()=>{x(null),window.scrollTo(0,0)},T=e=>{l(i.map(t=>t.id===e.id?e:t))},L=p.useMemo(()=>{const e=i.filter(e=>e.category===a);return"latest"===y?e:[...e].sort((e,t)=>(t.views||0)-(e.views||0))},[i,a,y]);return m?s.jsx(S,{post:m,onBack:E,onUpdatePost:T,onDeletePost:e=>{l(i.filter(t=>t.id!==e)),x(null)}}):s.jsxs("div",{className:"px-4 py-4 pb-20 min-h-screen",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-xl font-bold font-display text-slate-800 whitespace-nowrap",children:"ì»¤ë®¤ë‹ˆí‹°"}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("button",{onClick:()=>N("latest"),className:"px-3 py-1.5 text-xs font-medium rounded-lg transition-all cursor-pointer "+("latest"===y?"bg-cyan-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"),children:"ìµœì‹ ìˆœ"}),s.jsx("button",{onClick:()=>N("views"),className:"px-3 py-1.5 text-xs font-medium rounded-lg transition-all cursor-pointer "+("views"===y?"bg-cyan-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"),children:"ì¡°íšŒìˆœ"})]})]}),s.jsxs("div",{className:"flex space-x-3 mb-6 overflow-x-auto pb-2 scrollbar-hide",children:[s.jsx("button",{onClick:()=>r("dating"),className:"px-5 py-2.5 rounded-full text-sm font-bold whitespace-nowrap cursor-pointer transition-all duration-300 "+("dating"===a?"bg-gradient-to-r from-primary-500 to-primary-600 text-white shadow-lg shadow-primary-500/30 scale-105":"bg-white text-slate-500 hover:bg-slate-50 border border-slate-100"),children:"ì…€í”„ì†Œê°œíŒ…"}),s.jsx("button",{onClick:()=>r("chat"),className:"px-5 py-2.5 rounded-full text-sm font-bold whitespace-nowrap cursor-pointer transition-all duration-300 "+("chat"===a?"bg-gradient-to-r from-primary-500 to-primary-600 text-white shadow-lg shadow-primary-500/30 scale-105":"bg-white text-slate-500 hover:bg-slate-50 border border-slate-100"),children:"ìž¡ë‹´"})]}),s.jsxs("div",{className:"flex space-x-2 mb-6",children:[s.jsx("button",{className:"px-4 py-1.5 bg-primary-50 text-primary-600 rounded-full text-xs font-bold whitespace-nowrap cursor-pointer border border-primary-100",children:"ì¶”ì²œìˆœ"}),s.jsx("button",{className:"px-4 py-1.5 bg-white text-slate-400 rounded-full text-xs font-medium whitespace-nowrap cursor-pointer hover:bg-slate-50 border border-transparent hover:border-slate-100 transition-colors",children:"ìµœì‹ ìˆœ"})]}),h?s.jsx(w,{}):s.jsx("div",{className:"space-y-3",children:L.map(e=>s.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden cursor-pointer hover:shadow-lg hover:border-primary-100 transition-all duration-300",onClick:()=>(async e=>{if(g){try{await t.posts.incrementViews(e.id),l(i.map(t=>t.id===e.id?{...t,views:(t.views||0)+1}:t))}catch(s){}x(e)}else v(!0)})(e),children:s.jsxs("div",{className:"flex p-4",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-16 h-16 rounded-full p-0.5 bg-gradient-to-br from-pink-400 to-pink-500",children:s.jsx("img",{src:e.avatar,alt:e.author,className:"w-full h-full rounded-full object-cover border-2 border-white",onError:e=>{e.target.src="https://via.placeholder.com/100"}})})}),s.jsxs("div",{className:"flex-1 ml-3 min-w-0",children:[s.jsx("h3",{className:"text-[15px] font-bold text-slate-800 line-clamp-1 mb-1",children:e.content.split("\n")[0]}),s.jsxs("p",{className:"text-sm text-slate-500 mb-2",children:[e.author," (",e.location||"ìœ„ì¹˜ ë¯¸ì„¤ì •"," / ",e.age||"?","ì„¸ / ",e.job||"ì§ì—… ë¯¸ì„¤ì •",")"]}),s.jsxs("div",{className:"flex items-center space-x-3 text-xs text-slate-400",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("i",{className:"ri-eye-line"}),s.jsx("span",{children:e.views||0})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("i",{className:"ri-chat-3-line"}),s.jsx("span",{children:e.commentsCount||0})]}),s.jsx("span",{children:"|"}),s.jsx("span",{children:e.timeAgo})]})]}),e.image&&s.jsx("div",{className:"flex-shrink-0 ml-3",children:s.jsx("div",{className:"w-16 h-16 rounded-xl overflow-hidden",children:s.jsx("img",{src:e.image,alt:"ê²Œì‹œë¬¼ ì´ë¯¸ì§€",className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none"}})})})]})},e.id))}),s.jsx("button",{onClick:()=>e("/post/create"),className:"fixed bottom-24 right-6 w-14 h-14 bg-gradient-to-r from-primary-500 to-primary-600 text-white rounded-full shadow-lg shadow-primary-500/40 flex items-center justify-center hover:from-primary-600 hover:to-primary-700 hover:scale-110 transition-all cursor-pointer z-30 group",children:s.jsx("i",{className:"ri-add-line text-2xl group-hover:rotate-90 transition-transform duration-300"})}),c&&s.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-50 flex items-end animate-fade-in",children:s.jsxs("div",{className:"bg-white w-full rounded-t-[2rem] p-6 animate-slide-up shadow-2xl",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h3",{className:"text-xl font-bold font-display text-slate-800",children:"ìƒˆ ê¸€ ìž‘ì„±"}),s.jsx("button",{onClick:()=>d(!1),className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-slate-100 transition-colors cursor-pointer",children:s.jsx("i",{className:"ri-close-line text-xl text-slate-400"})})]}),s.jsx("textarea",{value:n,onChange:e=>o(e.target.value),placeholder:"ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ê³  ìžˆë‚˜ìš”?",className:"w-full px-5 py-4 border border-slate-200 rounded-2xl focus:ring-2 focus:ring-primary-500 focus:border-transparent text-sm resize-none bg-slate-50 placeholder-slate-400 transition-all",rows:5,maxLength:500}),s.jsxs("div",{className:"flex justify-between items-center mt-4",children:[s.jsxs("span",{className:"text-xs font-medium text-slate-400",children:[n.length,"/500"]}),s.jsx("button",{onClick:async()=>{if(n.trim())if(g)try{const e={author_name:g.name||"ìµëª…",avatar_url:g.profile_image||g.avatar_url||"",content:n,likes:0,views:0,category:a,age:g.age,location:g.location,job:g.school||g.job},{post:s,error:r}=await t.posts.createPost(g.id,e);if(r)throw r;if(s){const e={id:s.id,author:s.author_name||"ìµëª…",avatar:s.avatar_url||"",content:s.content||"",image:s.image_url,likes:0,comments:[],timeAgo:"ë°©ê¸ˆ ì „",isLiked:!1,age:s.age,location:s.location,job:s.job,views:0,category:s.category||"dating"};l([e,...i]),o(""),d(!1)}}catch(e){alert("ê²Œì‹œê¸€ ìž‘ì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}else alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.")},className:"px-6 py-2.5 bg-gradient-to-r from-primary-500 to-primary-600 text-white rounded-full hover:from-primary-600 hover:to-primary-700 transition-all cursor-pointer whitespace-nowrap text-sm font-bold shadow-lg shadow-primary-500/30",children:"ê²Œì‹œí•˜ê¸°"})]})]})}),j&&s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[s.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-md",onClick:()=>v(!1)}),s.jsxs("div",{className:"relative bg-white rounded-3xl p-8 max-w-sm w-full mx-4 text-center shadow-2xl",children:[s.jsx("div",{className:"w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx("i",{className:"ri-lock-line text-3xl text-primary-500"})}),s.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-2",children:"ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤"}),s.jsx("p",{className:"text-slate-500 text-sm mb-6",children:"ê²Œì‹œê¸€ì„ ë³´ë ¤ë©´ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”"}),s.jsx("button",{onClick:()=>e("/login"),className:"w-full bg-gradient-to-r from-primary-500 to-primary-600 text-white py-3 rounded-2xl font-bold hover:from-primary-600 hover:to-primary-700 transition-all",children:"ë¡œê·¸ì¸í•˜ê¸°"})]})]})]})}const T=e=>"male"===e?"https://readdy.ai/api/search-image?query=minimalist%20male%20silhouette%20profile%20avatar%20icon%20on%20clean%20white%20background%20simple%20modern%20design%20professional%20business%20style%20neutral%20gray%20color%20scheme%20front%20facing%20head%20and%20shoulders%20portrait%20clean%20lines%20vector%20style%20illustration&width=300&height=300&seq=male-default-avatar&orientation=squarish":"https://readdy.ai/api/search-image?query=minimalist%20female%20silhouette%20profile%20avatar%20icon%20on%20clean%20white%20background%20simple%20modern%20design%20professional%20business%20style%20neutral%20gray%20color%20scheme%20front%20facing%20head%20and%20shoulders%20portrait%20clean%20lines%20vector%20style%20illustration&width=300&height=300&seq=female-default-avatar&orientation=squarish";function L({onChatViewChange:a}){const f=u(),{user:g}=e(),[b,j]=p.useState(null),[v,y]=p.useState(""),w=p.useRef(null),[N,k]=p.useState([]),[C,_]=p.useState([]),[S,I]=p.useState(!0),[D,E]=p.useState(!1),[L,M]=p.useState(!1);p.useEffect(()=>{a?.(!!b)},[b,a]),p.useEffect(()=>{b&&w.current&&w.current.scrollIntoView({behavior:"smooth"})},[C,b]),p.useEffect(()=>{const e=()=>{b&&(j(null),_([]))};return b&&window.history.pushState({chatRoom:!0},""),window.addEventListener("popstate",e),()=>{window.removeEventListener("popstate",e)}},[b]),p.useEffect(()=>{if(!g?.id)return;q();const e=r(l(o,"chat_rooms"),i("user1_id","==",g.id)),t=r(l(o,"chat_rooms"),i("user2_id","==",g.id)),s=n(e,()=>{q()}),a=n(t,()=>{q()});return()=>{s(),a()}},[g?.id]),p.useEffect(()=>{if(!b||!g?.id)return;const e=l(o,"chat_rooms",b.roomId,"messages"),t=r(e,c("created_at","asc")),s=n(t,e=>{const t=e.docs.map(e=>{const t=e.data();return{id:e.id,senderId:t.sender_id,content:t.message,timestamp:t.created_at?new Date(t.created_at.toDate()).toLocaleTimeString("ko-KR",{hour:"numeric",minute:"2-digit",hour12:!0}):"ì „ì†¡ ì¤‘...",isRead:t.read}});_(t);const s=e.docs.filter(e=>e.data().sender_id!==g.id&&!e.data().read);if(s.length>0){const e=h(o);s.forEach(t=>{e.update(t.ref,{read:!0})}),e.commit()}});return()=>s()},[b?.roomId,g?.id]);const q=async()=>{if(g?.id)try{I(!0);const{chatRooms:e,error:s}=await t.chat.getUserChatRooms(g.id);if(s)return void k([]);if(!e||0===e.length)return void k([]);const a=await Promise.all(e.map(async e=>{const s=e.user1_id===g.id?e.user2_id:e.user1_id,{user:a}=await t.users.getUserById(s);let n=0;try{const t=l(o,"chat_rooms",e.id,"messages"),a=r(t,i("sender_id","==",s),i("read","==",!1));n=(await d(a)).size}catch(c){}return{roomId:e.id,partnerId:s,partnerName:a?.name||"ì‚¬ìš©ìž",partnerAvatar:a?.profile_image||a?.avatar_url||T(a?.gender),partnerGender:a?.gender,lastMessage:e.last_message||"ëŒ€í™”ë¥¼ ì‹œìž‘í•´ë³´ì„¸ìš”!",lastMessageTime:e.last_message_at?new Date(e.last_message_at.toDate()).toLocaleTimeString("ko-KR",{hour:"numeric",minute:"2-digit",hour12:!0}):"ë°©ê¸ˆ ì „",unreadCount:n}}));a.sort((e,t)=>{const s="ë°©ê¸ˆ ì „"===e.lastMessageTime?Date.now():0;return("ë°©ê¸ˆ ì „"===t.lastMessageTime?Date.now():0)-s}),k(a)}catch(e){k([])}finally{I(!1)}},A=async e=>{try{const{user:s,error:a}=await t.users.getUserById(e);if(a||!s)throw a||new Error("User not found");f("/profile-detail",{state:{profile:{id:s.id,name:s.name,age:s.age,gender:s.gender,location:s.location,school:s.school,mbti:s.mbti,bio:s.bio,photos:s.profile_image?[s.profile_image]:[],interests:s.interests||[],height:s.height,bodyType:s.body_type,style:s.style,religion:s.religion,smoking:s.smoking,drinking:s.drinking,isMatched:!0}}})}catch(s){alert("í”„ë¡œí•„ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}},z=async()=>{if(b){M(!0);try{const e=m(o,"chat_rooms",b.roomId);await x(e),k(e=>e.filter(e=>e.roomId!==b.roomId)),j(null),_([]),E(!1),alert("ì±„íŒ…ë°©ì„ ë‚˜ê°”ìŠµë‹ˆë‹¤.")}catch(e){alert("ì±„íŒ…ë°© ë‚˜ê°€ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{M(!1)}}},$=async()=>{if(v.trim()&&b&&g?.id)try{const{error:e}=await t.chat.sendMessage(b.roomId,g.id,v);if(e)throw e;y("")}catch(e){alert(`ë©”ì‹œì§€ ì „ì†¡ ì‹¤íŒ¨: ${e.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}`)}},P=e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),$())},B=()=>{j(null),_([]),window.history.replaceState(null,"")};return b?s.jsx("div",{className:"fixed inset-0 z-50 flex justify-center bg-slate-100",children:s.jsxs("div",{className:"w-full max-w-[400px] bg-white flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-slate-100 bg-white flex-shrink-0",style:{paddingTop:"max(12px, env(safe-area-inset-top))"},children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("button",{onClick:B,className:"w-10 h-10 flex items-center justify-center cursor-pointer hover:bg-slate-100 rounded-full transition-colors",children:s.jsx("i",{className:"ri-arrow-left-line text-xl text-slate-600"})}),s.jsxs("button",{onClick:()=>A(b.partnerId),className:"flex items-center space-x-3 cursor-pointer hover:opacity-80 transition-opacity",children:[s.jsx("img",{src:b.partnerAvatar||T(b.partnerGender),alt:b.partnerName,className:"w-10 h-10 rounded-full object-cover object-top shadow-sm",onError:e=>{e.target.src=T(b.partnerGender)}}),s.jsxs("div",{className:"text-left",children:[s.jsx("h3",{className:"font-bold text-slate-800",children:b.partnerName}),s.jsx("span",{className:"text-[10px] text-slate-400",children:"í”„ë¡œí•„ ë³´ê¸° â†’"})]})]})]}),s.jsx("button",{onClick:()=>E(!0),className:"w-10 h-10 flex items-center justify-center cursor-pointer hover:bg-red-50 rounded-full transition-colors text-slate-400 hover:text-red-500",children:s.jsx("i",{className:"ri-logout-box-r-line text-xl"})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50",children:[0===C.length?s.jsxs("div",{className:"text-center py-16",children:[s.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx("i",{className:"ri-chat-smile-2-line text-3xl text-slate-400"})}),s.jsx("p",{className:"text-slate-500 text-sm",children:"ì²« ë©”ì‹œì§€ë¥¼ ë³´ë‚´ë³´ì„¸ìš”! ðŸ’¬"})]}):C.map(e=>s.jsx("div",{className:"flex "+(e.senderId===g?.id?"justify-end":"justify-start"),children:s.jsxs("div",{className:"flex items-end space-x-2 max-w-[75%] "+(e.senderId!==g?.id?"flex-row":"flex-row-reverse space-x-reverse"),children:[e.senderId!==g?.id&&s.jsx("button",{onClick:()=>A(b.partnerId),className:"flex-shrink-0",children:s.jsx("img",{src:b.partnerAvatar||T(b.partnerGender),alt:b.partnerName,className:"w-8 h-8 rounded-full object-cover object-top shadow-sm mb-1 cursor-pointer hover:opacity-80 transition-opacity",onError:e=>{e.target.src=T(b.partnerGender)}})}),s.jsxs("div",{className:"flex flex-col",children:[e.senderId!==g?.id&&s.jsx("span",{className:"text-xs text-slate-400 mb-1 ml-1",children:b.partnerName}),s.jsxs("div",{className:"flex items-end space-x-1",children:[e.senderId===g?.id&&s.jsx("span",{className:"text-[10px] text-slate-400 mb-1",children:e.timestamp}),s.jsx("div",{className:"px-4 py-2.5 rounded-2xl shadow-sm "+(e.senderId===g?.id?"bg-gradient-to-r from-cyan-500 to-blue-500 text-white rounded-br-sm":"bg-white text-slate-700 rounded-bl-sm border border-slate-100"),children:s.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap break-words",children:e.content})}),e.senderId!==g?.id&&s.jsx("span",{className:"text-[10px] text-slate-400 mb-1",children:e.timestamp})]})]})]})},e.id)),s.jsx("div",{ref:w})]}),s.jsx("div",{className:"px-4 pt-3 bg-white border-t border-slate-100 flex-shrink-0",style:{paddingBottom:"calc(12px + env(safe-area-inset-bottom, 12px))"},children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("input",{type:"text",value:v,onChange:e=>y(e.target.value),onKeyPress:P,placeholder:"ë©”ì‹œì§€ë¥¼ ìž…ë ¥í•˜ì„¸ìš”...",className:"flex-1 px-4 py-2.5 bg-slate-100 rounded-full focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:bg-white transition-all text-sm",maxLength:500}),s.jsx("button",{onClick:$,disabled:!v.trim(),className:"w-10 h-10 rounded-full flex items-center justify-center transition-all cursor-pointer flex-shrink-0 "+(v.trim()?"bg-gradient-to-r from-cyan-500 to-blue-500 text-white hover:scale-105 shadow-md":"bg-slate-200 text-slate-400 cursor-not-allowed"),children:s.jsx("i",{className:"ri-send-plane-fill text-base"})})]})}),D&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[60] flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-sm p-6",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx("i",{className:"ri-logout-box-r-line text-3xl text-red-500"})}),s.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-2",children:"ì±„íŒ…ë°© ë‚˜ê°€ê¸°"}),s.jsxs("p",{className:"text-sm text-slate-500",children:["ì±„íŒ…ë°©ì„ ë‚˜ê°€ë©´ ëª¨ë“  ëŒ€í™” ë‚´ìš©ì´ ì‚­ì œë©ë‹ˆë‹¤.",s.jsx("br",{}),"ì •ë§ ë‚˜ê°€ì‹œê² ìŠµë‹ˆê¹Œ?"]})]}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:()=>E(!1),className:"flex-1 py-3 bg-slate-100 text-slate-600 rounded-xl font-medium",disabled:L,children:"ì·¨ì†Œ"}),s.jsx("button",{onClick:z,disabled:L,className:"flex-1 py-3 bg-red-500 text-white rounded-xl font-medium disabled:opacity-50",children:L?"ë‚˜ê°€ëŠ” ì¤‘...":"ë‚˜ê°€ê¸°"})]})]})})]})}):s.jsxs("div",{className:"min-h-screen px-5 pt-2",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"ì±„íŒ…"}),s.jsx("button",{onClick:q,className:"w-10 h-10 rounded-full bg-white shadow-sm flex items-center justify-center text-slate-400 hover:text-cyan-500 hover:shadow-md transition-all",children:s.jsx("i",{className:"ri-refresh-line text-xl"})})]}),S?s.jsx("div",{className:"space-y-4",children:[1,2,3].map(e=>s.jsx("div",{className:"bg-white rounded-2xl p-4 animate-pulse",children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-14 h-14 rounded-full bg-slate-200"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"h-4 bg-slate-200 rounded w-24 mb-2"}),s.jsx("div",{className:"h-3 bg-slate-100 rounded w-40"})]})]})},e))}):N.length>0?s.jsxs("div",{className:"space-y-3",children:[s.jsxs("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider px-1 mb-3",children:["ë§¤ì¹­ëœ ëŒ€í™” (",N.length,")"]}),N.map(e=>s.jsx("div",{onClick:()=>(e=>{j(e),(async()=>{})(e.roomId)})(e),className:"bg-white rounded-2xl p-4 shadow-sm hover:shadow-md transition-all cursor-pointer border border-slate-100 active:scale-[0.98]",children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"relative flex-shrink-0",children:[s.jsx("img",{src:e.partnerAvatar||T(e.partnerGender),alt:e.partnerName,className:"w-14 h-14 rounded-full object-cover object-top shadow-sm",onError:t=>{t.target.src=T(e.partnerGender)}}),e.unreadCount>0&&s.jsx("div",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-[10px] font-bold rounded-full w-5 h-5 flex items-center justify-center",children:e.unreadCount})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("h3",{className:"font-bold text-slate-800 truncate",children:e.partnerName}),s.jsx("span",{className:"text-[11px] text-slate-400 flex-shrink-0 ml-2",children:e.lastMessageTime})]}),s.jsx("p",{className:"text-sm truncate "+(e.unreadCount>0?"text-slate-800 font-medium":"text-slate-500"),children:e.lastMessage})]}),s.jsx("i",{className:"ri-arrow-right-s-line text-slate-300 text-xl"})]})},e.roomId))]}):s.jsxs("div",{className:"text-center py-20",children:[s.jsx("div",{className:"w-20 h-20 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-6",children:s.jsx("i",{className:"ri-chat-3-line text-4xl text-slate-300"})}),s.jsx("h3",{className:"text-xl font-bold text-slate-700 mb-2",children:"ì•„ì§ ì±„íŒ…ì´ ì—†ì–´ìš”"}),s.jsx("p",{className:"text-slate-500 mb-2",children:"ë§¤ì¹­ì´ ì„±ì‚¬ë˜ë©´ ì±„íŒ…ì„ ì‹œìž‘í•  ìˆ˜ ìžˆì–´ìš”!"}),s.jsxs("p",{className:"text-xs text-slate-400",children:["ë§¤ì¹­ íƒ­ì—ì„œ ë§ˆìŒì— ë“œëŠ” ìƒëŒ€ì—ê²Œ",s.jsx("br",{}),"í•˜íŠ¸ë¥¼ ë³´ë‚´ë³´ì„¸ìš” ðŸ’•"]})]})]})}function M({unit:e,width:t=320,height:a=100,className:r=""}){const i=p.useRef(null),l=p.useRef(!1);return p.useEffect(()=>{if(!e)return;if(l.current)return;const t=document.createElement("script");t.src="https://t1.daumcdn.net/kas/static/ba.min.js",t.async=!0,t.onload=()=>{l.current=!0,i.current&&(i.current.style.display="block")},t.onerror=()=>{};return document.querySelector('script[src="https://t1.daumcdn.net/kas/static/ba.min.js"]')?(l.current=!0,i.current&&(i.current.style.display="block")):document.head.appendChild(t),()=>{i.current&&(i.current.innerHTML="")}},[e]),e?s.jsx("div",{className:`flex justify-center ${r}`,children:s.jsx("ins",{ref:i,className:"kakao_ad_area",style:{display:"none",width:`${t}px`,height:`${a}px`},"data-ad-unit":e,"data-ad-width":t.toString(),"data-ad-height":a.toString()})}):null}const q=e=>"ë‚¨ìž"===e||"male"===e?"https://readdy.ai/api/search-image?query=minimalist%20male%20silhouette%20profile%20avatar%20icon%20on%20clean%20white%20background%20simple%20modern%20design%20professional%20business%20style%20neutral%20gray%20color%20scheme%20front%20facing%20head%20and%20shoulders%20portrait%20clean%20lines%20vector%20style%20illustration&width=300&height=300&seq=male-default-avatar&orientation=squarish":"https://readdy.ai/api/search-image?query=minimalist%20female%20silhouette%20profile%20avatar%20icon%20on%20clean%20white%20background%20simple%20modern%20design%20professional%20business%20style%20neutral%20gray%20color%20scheme%20front%20facing%20head%20and%20shoulders%20portrait%20clean%20lines%20vector%20style%20illustration&width=300&height=300&seq=female-default-avatar&orientation=squarish";function A(){const a=u(),{user:r}=e(),[i,l]=p.useState({name:"ì‚¬ìš©ìž",age:0,gender:"ì—¬ìž",location:"ìœ„ì¹˜ ë¯¸ì„¤ì •",avatar:"",bio:"",interests:[]}),[n,o]=p.useState({received:0,sent:0}),[c,d]=p.useState(!0);p.useEffect(()=>{m(),x()},[r?.id]);const m=async()=>{try{if(!r?.id)return void d(!1);const{user:e,error:s}=await t.users.getUserById(r.id);if(s)return void d(!1);e&&l({name:e.name||"ì‚¬ìš©ìž",age:e.age||0,gender:"male"===e.gender?"ë‚¨ìž":"ì—¬ìž",location:e.location||"ìœ„ì¹˜ ë¯¸ì„¤ì •",avatar:e.avatar_url||e.profile_image||"",bio:e.bio||"",interests:e.interests||[]})}catch(e){}finally{d(!1)}},x=async()=>{try{if(!r?.id)return;const{requests:e}=await t.matching.getReceivedRequests(r.id,"pending"),{requests:s}=await t.matching.getSentRequests(r.id,"pending");o({received:e.length||0,sent:s.length||0})}catch(e){}};if(c)return s.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-slate-50 space-y-4",children:[s.jsxs("div",{className:"relative w-16 h-16",children:[s.jsx("div",{className:"absolute inset-0 border-4 border-slate-200 rounded-full"}),s.jsx("div",{className:"absolute inset-0 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"})]}),s.jsx("div",{className:"text-sm font-medium text-slate-500",children:"í”„ë¡œí•„ ë¡œë“œ ì¤‘..."})]});const h=()=>{a("/profile-edit")},f=()=>{a("/matching-requests")};return s.jsx("div",{className:"px-4 py-6 pb-20 min-h-screen",children:s.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-[2rem] shadow-lg shadow-primary-500/5 p-8 animate-slide-up relative overflow-hidden group",children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-32 bg-gradient-to-br from-primary-100 to-secondary-100 opacity-50"}),s.jsxs("div",{className:"relative text-center",children:[s.jsxs("div",{className:"relative inline-block mb-4",children:[s.jsx("div",{className:"p-1 bg-white rounded-full shadow-lg",children:s.jsx("img",{src:i.avatar||q(i.gender),alt:i.name,className:"w-28 h-28 rounded-full object-cover group-hover:scale-105 transition-transform duration-500",onError:e=>{e.target.src=q(i.gender)}})}),s.jsx("button",{onClick:h,className:"absolute bottom-2 right-2 w-9 h-9 bg-slate-800 text-white rounded-full flex items-center justify-center shadow-lg hover:bg-black transition-colors cursor-pointer hover:scale-110 transform duration-300 border-2 border-white",children:s.jsx("i",{className:"ri-camera-line text-lg"})})]}),s.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-1 font-display",children:i.name}),s.jsxs("p",{className:"text-slate-500 mb-4 font-medium",children:[i.age,"ì„¸ Â· ",i.location]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("button",{onClick:h,className:"w-full bg-slate-800 text-white py-3 rounded-2xl font-bold hover:bg-black transition-all cursor-pointer whitespace-nowrap shadow-lg shadow-slate-200 hover:shadow-xl transform hover:-translate-y-0.5",children:"í”„ë¡œí•„ ìˆ˜ì •í•˜ê¸°"}),s.jsxs("button",{onClick:()=>a("/my-profile"),className:"w-full bg-gradient-to-r from-primary-500 to-secondary-500 text-white py-3 rounded-2xl font-bold hover:from-primary-600 hover:to-secondary-600 transition-all cursor-pointer whitespace-nowrap flex items-center justify-center gap-2",children:[s.jsx("i",{className:"ri-eye-line"}),"ë‚´ í”„ë¡œí•„ ë¯¸ë¦¬ë³´ê¸°"]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-[2rem] shadow-lg shadow-primary-500/5 p-6 animate-slide-up",style:{animationDelay:"0.1s"},children:[s.jsxs("div",{className:"flex items-center justify-between mb-5",children:[s.jsx("h3",{className:"font-bold text-lg text-slate-800 font-display",children:"ë§¤ì¹­ í˜„í™©"}),s.jsx("button",{onClick:f,className:"text-primary-500 text-sm font-medium hover:text-primary-600 cursor-pointer",children:"ì „ì²´ë³´ê¸°"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{onClick:f,className:"bg-gradient-to-br from-pink-50 to-pink-100 rounded-2xl p-4 cursor-pointer hover:shadow-md transition-all",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm",children:s.jsx("i",{className:"ri-heart-fill text-pink-500 text-xl"})}),s.jsx("span",{className:"text-2xl font-bold text-pink-600",children:n.received})]}),s.jsx("div",{className:"text-sm font-bold text-pink-700",children:"ë°›ì€ ìš”ì²­"}),s.jsx("div",{className:"text-xs text-pink-500 mt-0.5",children:"ìƒˆë¡œìš´ ê´€ì‹¬ í‘œì‹œ"})]}),s.jsxs("div",{onClick:f,className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-2xl p-4 cursor-pointer hover:shadow-md transition-all",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm",children:s.jsx("i",{className:"ri-send-plane-fill text-blue-500 text-xl"})}),s.jsx("span",{className:"text-2xl font-bold text-blue-600",children:n.sent})]}),s.jsx("div",{className:"text-sm font-bold text-blue-700",children:"ë³´ë‚¸ ìš”ì²­"}),s.jsx("div",{className:"text-xs text-blue-500 mt-0.5",children:"ëŒ€ê¸° ì¤‘ì¸ ìš”ì²­"})]})]})]}),s.jsx("div",{className:"animate-slide-up",style:{animationDelay:"0.2s"},children:s.jsx(M,{unit:"DAN-xzcTogwnUXAFXJ7t",width:320,height:100,className:"mx-auto"})}),s.jsx("div",{className:"animate-slide-up",style:{animationDelay:"0.25s"},children:s.jsx(M,{unit:"DAN-VPAvNk4a33lBM3D8",width:320,height:100,className:"mx-auto"})}),s.jsx("div",{className:"bg-white rounded-[2rem] shadow-lg shadow-primary-500/5 p-4 animate-slide-up",style:{animationDelay:"0.3s"},children:s.jsxs("div",{className:"space-y-1",children:[s.jsxs("button",{onClick:()=>a("/settings"),className:"w-full flex items-center justify-between p-4 hover:bg-slate-50 rounded-2xl transition-all cursor-pointer group",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-full flex items-center justify-center group-hover:bg-blue-100 transition-colors",children:s.jsx("i",{className:"ri-settings-3-line text-blue-500 text-xl"})}),s.jsx("span",{className:"font-bold text-slate-700 group-hover:text-slate-900",children:"ì„¤ì •"})]}),s.jsx("i",{className:"ri-arrow-right-s-line text-slate-300 group-hover:text-slate-500 text-xl transition-colors"})]}),s.jsxs("button",{onClick:()=>alert("ê°œì¸ì •ë³´ ë³´í˜¸ ì •ì±… íŽ˜ì´ì§€ ì¤€ë¹„ì¤‘ìž…ë‹ˆë‹¤."),className:"w-full flex items-center justify-between p-4 hover:bg-slate-50 rounded-2xl transition-all cursor-pointer group",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-10 h-10 bg-green-50 rounded-full flex items-center justify-center group-hover:bg-green-100 transition-colors",children:s.jsx("i",{className:"ri-shield-check-line text-green-500 text-xl"})}),s.jsx("span",{className:"font-bold text-slate-700 group-hover:text-slate-900",children:"ê°œì¸ì •ë³´ ë³´í˜¸"})]}),s.jsx("i",{className:"ri-arrow-right-s-line text-slate-300 group-hover:text-slate-500 text-xl transition-colors"})]}),s.jsxs("button",{onClick:()=>a("/support"),className:"w-full flex items-center justify-between p-4 hover:bg-slate-50 rounded-2xl transition-all cursor-pointer group",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-10 h-10 bg-purple-50 rounded-full flex items-center justify-center group-hover:bg-purple-100 transition-colors",children:s.jsx("i",{className:"ri-question-line text-purple-500 text-xl"})}),s.jsx("span",{className:"font-bold text-slate-700 group-hover:text-slate-900",children:"ê³ ê°ì„¼í„°"})]}),s.jsx("i",{className:"ri-arrow-right-s-line text-slate-300 group-hover:text-slate-500 text-xl transition-colors"})]})]})})]})})}function z(){const t=u(),a=f(),{user:r,loading:i}=e(),[l,n]=p.useState("matching"),[o]=p.useState(150),[c,d]=p.useState(!1);p.useEffect(()=>{a.state&&a.state.activeTab&&(n(a.state.activeTab),window.history.replaceState({},document.title))},[a]);const m=p.useCallback(e=>{n(e),window.scrollTo({top:0,behavior:"smooth"})},[]);if(p.useEffect(()=>{if(!i){const e=localStorage.getItem("auth_user");r||e||t("/login")}},[i,r,t]),i)return s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"ë¡œë”© ì¤‘..."})]})});return s.jsxs("div",{className:"min-h-screen bg-slate-50",children:[!c&&s.jsx(g,{coins:o}),s.jsx("main",{className:c?"":"pb-28",style:c?{}:{paddingTop:"calc(5rem + env(safe-area-inset-top))"},children:(()=>{switch(l){case"matching":default:return s.jsx(_,{});case"community":return s.jsx(E,{});case"chat":return s.jsx(L,{onChatViewChange:d});case"profile":return s.jsx(A,{})}})()}),!c&&s.jsx(b,{activeTab:l,onTabChange:m})]})}export{z as default};

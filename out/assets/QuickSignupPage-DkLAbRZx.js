import{j as e,s as t,h as r}from"./index-BQmPUlpM.js";import{d as l,r as s}from"./vendor-D2kRphhb.js";import"./supabase-XLYZcxPH.js";function a(){const a=l(),[n,i]=s.useState({name:"",phoneNumber:"",password:"",age:"",gender:"",location:"",bio:"",mbti:"",school:"",height:"",bodyType:"",style:"",religion:"",smoking:"",drinking:""}),[o,d]=s.useState(null),[c,p]=s.useState(""),[x,u]=s.useState(!1),[g,m]=s.useState([]),[b,h]=s.useState(""),y=e=>{const{name:t,value:r}=e.target;i(e=>({...e,[t]:r}))},f=()=>{b.trim()&&!g.includes(b.trim())&&(m([...g,b.trim()]),h(""))};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-pink-50 to-rose-50 py-4 px-4",children:e.jsxs("div",{className:"w-full max-w-md mx-auto",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-purple-600 to-rose-600 bg-clip-text text-transparent mb-1",children:"âš¡ ë¹ ë¥¸ íšŒì›ê°€ì…"}),e.jsx("p",{className:"text-xs text-gray-500",children:"í…ŒìŠ¤íŠ¸ìš© ìœ ë ¹ íšŒì› ìƒì„± (ëª¨ë“  í•„ë“œ)"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"text-sm font-bold text-gray-800",children:"ğŸ‘» ìœ ë ¹ íšŒì› ì •ë³´"}),e.jsx("button",{type:"button",onClick:()=>a("/login"),className:"text-xs text-gray-500 hover:text-gray-700",children:"â† ëŒì•„ê°€ê¸°"})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),n.name.trim())if(!n.phoneNumber||n.phoneNumber.length<13)alert("ì˜¬ë°”ë¥¸ ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");else if(!n.password||n.password.length<4)alert("ë¹„ë°€ë²ˆí˜¸ëŠ” 4ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.");else if(n.gender)if(o){u(!0);try{const e=await(async()=>{if(!o)return null;try{const e=o.name.split(".").pop(),r=`avatars/${Date.now()}_${Math.random().toString(36).substring(7)}.${e}`,{error:l}=await t.storage.from("avatars").upload(r,o,{cacheControl:"3600",upsert:!1});if(l)throw l;const{data:{publicUrl:s}}=t.storage.from("avatars").getPublicUrl(r);return s}catch(x){return null}})();if(!e)return alert("ì´ë¯¸ì§€ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),void u(!1);const l=n.phoneNumber.replace(/[^\d]/g,""),{data:s}=await t.from("users").select("id").eq("phone_number",l).maybeSingle();if(s)return alert("ì´ë¯¸ ë“±ë¡ëœ ì „í™”ë²ˆí˜¸ì…ë‹ˆë‹¤."),void u(!1);const a=await r(n.password),{data:c,error:x}=await t.from("users").insert({phone_number:l,password_hash:a,name:n.name.trim(),age:n.age?parseInt(n.age):null,gender:n.gender,location:n.location.trim()||null,bio:n.bio.trim()||null,mbti:n.mbti.toUpperCase()||null,school:n.school.trim()||null,height:n.height||null,body_type:n.bodyType||null,style:n.style||null,religion:n.religion||null,smoking:n.smoking||null,drinking:n.drinking||null,interests:g.length>0?g:null,profile_image:e,is_ghost:!0,profile_completed:!0,created_at:(new Date).toISOString()}).select().single();if(x)return alert("íšŒì›ê°€ì…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),void u(!1);alert(`íšŒì›ê°€ì… ì™„ë£Œ!\n${n.name}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤!`),i({name:"",phoneNumber:"",password:"",age:"",gender:"",location:"",bio:"",mbti:"",school:"",height:"",bodyType:"",style:"",religion:"",smoking:"",drinking:""}),d(null),p(""),m([])}catch(l){alert("íšŒì›ê°€ì… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{u(!1)}}else alert("í”„ë¡œí•„ ì‚¬ì§„ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.");else alert("ì„±ë³„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");else alert("ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")},className:"space-y-3",children:[e.jsx("div",{className:"flex justify-center mb-2",children:c?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:c,alt:"ë¯¸ë¦¬ë³´ê¸°",className:"w-20 h-20 object-cover rounded-full border-2 border-purple-300"}),e.jsx("button",{type:"button",onClick:()=>{d(null),p("")},className:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-5 h-5 text-xs flex items-center justify-center",children:"âœ•"})]}):e.jsxs("label",{className:"w-20 h-20 bg-purple-50 border-2 border-dashed border-purple-300 rounded-full flex flex-col items-center justify-center cursor-pointer hover:bg-purple-100",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:e=>{const t=e.target.files?.[0];if(!t)return;if(t.size>5242880)return void alert("íŒŒì¼ í¬ê¸°ëŠ” 5MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.");if(!t.type.startsWith("image/"))return void alert("ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.");d(t);const r=new FileReader;r.onloadend=()=>{p(r.result)},r.readAsDataURL(t)},className:"hidden"}),e.jsx("i",{className:"ri-camera-line text-purple-500 text-lg"}),e.jsx("span",{className:"text-[10px] text-purple-600",children:"ì‚¬ì§„*"})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",name:"name",value:n.name,onChange:y,placeholder:"ì´ë¦„ *",className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0}),e.jsx("input",{type:"number",name:"age",value:n.age,onChange:y,placeholder:"ë‚˜ì´",className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500",min:"18",max:"100"})]}),e.jsx("input",{type:"tel",name:"phoneNumber",value:n.phoneNumber,onChange:e=>{const t=(e=>{const t=e.replace(/[^\d]/g,"");return t.length<=3?t:t.length<=7?`${t.slice(0,3)}-${t.slice(3)}`:`${t.slice(0,3)}-${t.slice(3,7)}-${t.slice(7,11)}`})(e.target.value);i(e=>({...e,phoneNumber:t}))},placeholder:"ì „í™”ë²ˆí˜¸ * (010-1234-5678)",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500",maxLength:13,required:!0}),e.jsx("input",{type:"password",name:"password",value:n.password,onChange:y,placeholder:"ë¹„ë°€ë²ˆí˜¸ * (4ì ì´ìƒ)",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500",minLength:4,required:!0}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{type:"button",onClick:()=>i(e=>({...e,gender:"male"})),className:"py-2 rounded-lg text-sm font-medium transition-all "+("male"===n.gender?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:"ë‚¨ì"}),e.jsx("button",{type:"button",onClick:()=>i(e=>({...e,gender:"female"})),className:"py-2 rounded-lg text-sm font-medium transition-all "+("female"===n.gender?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:"ì—¬ì"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",name:"school",value:n.school,onChange:y,placeholder:"í•™êµ",className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500"}),e.jsx("input",{type:"text",name:"location",value:n.location,onChange:y,placeholder:"ì§€ì—­",className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"MBTI"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:["INTJ","INTP","ENTJ","ENTP","INFJ","INFP","ENFJ","ENFP","ISTJ","ISFJ","ESTJ","ESFJ","ISTP","ISFP","ESTP","ESFP"].map(t=>e.jsx("button",{type:"button",onClick:()=>i(e=>({...e,mbti:t})),className:"px-2 py-1 rounded text-xs transition-all "+(n.mbti===t?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"í‚¤"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:["150~155","155~160","160~165","165~170","170~175","175~180","180~185","185~190"].map(t=>e.jsx("button",{type:"button",onClick:()=>i(e=>({...e,height:t})),className:"px-2 py-1 rounded text-xs transition-all "+(n.height===t?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"ì²´í˜•"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:["ë§ˆë¥¸","ë³´í†µ","í†µí†µ","ê·¼ìœ¡ì§ˆ","ê±´ì¥í•œ"].map(t=>e.jsx("button",{type:"button",onClick:()=>i(e=>({...e,bodyType:t})),className:"px-2 py-1 rounded text-xs transition-all "+(n.bodyType===t?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"ìŠ¤íƒ€ì¼"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:["ìºì£¼ì–¼","ìŠ¤í¬í‹°","ëª¨ë˜","í´ë˜ì‹","ìŠ¤íŠ¸ë¦¿","í˜ë¯¸ë‹Œ"].map(t=>e.jsx("button",{type:"button",onClick:()=>i(e=>({...e,style:t})),className:"px-2 py-1 rounded text-xs transition-all "+(n.style===t?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"ì¢…êµ"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:["ë¬´êµ","ê¸°ë…êµ","ì²œì£¼êµ","ë¶ˆêµ","ì›ë¶ˆêµ","ê¸°íƒ€"].map(t=>e.jsx("button",{type:"button",onClick:()=>i(e=>({...e,religion:t})),className:"px-2 py-1 rounded text-xs transition-all "+(n.religion===t?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:t},t))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"í¡ì—°"}),e.jsx("div",{className:"flex gap-1",children:["ë¹„í¡ì—°","í¡ì—°"].map(t=>e.jsx("button",{type:"button",onClick:()=>i(e=>({...e,smoking:t})),className:"px-2 py-1 rounded text-xs flex-1 transition-all "+(n.smoking===t?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"ìŒì£¼"}),e.jsx("div",{className:"flex gap-1",children:["ì•ˆ ë§ˆì‹¬","ê°€ë”","ìì£¼"].map(t=>e.jsx("button",{type:"button",onClick:()=>i(e=>({...e,drinking:t})),className:"px-2 py-1 rounded text-xs flex-1 transition-all "+(n.drinking===t?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:t},t))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"ê´€ì‹¬ì‚¬"}),e.jsxs("div",{className:"flex gap-1 mb-1",children:[e.jsx("input",{type:"text",value:b,onChange:e=>h(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),f())},placeholder:"ê´€ì‹¬ì‚¬ ì…ë ¥ í›„ ì¶”ê°€",className:"flex-1 px-2 py-1.5 border border-gray-200 rounded text-xs focus:outline-none focus:ring-2 focus:ring-purple-500"}),e.jsx("button",{type:"button",onClick:f,className:"px-3 py-1.5 bg-purple-500 text-white rounded text-xs hover:bg-purple-600",children:"ì¶”ê°€"})]}),g.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:g.map((t,r)=>e.jsxs("span",{className:"bg-purple-100 text-purple-700 px-2 py-0.5 rounded-full text-xs flex items-center gap-1",children:[t," ",e.jsx("button",{type:"button",onClick:()=>m(g.filter((e,t)=>t!==r)),className:"text-purple-500 hover:text-purple-700",children:"Ã—"})]},r))})]}),e.jsx("textarea",{name:"bio",value:n.bio,onChange:y,placeholder:"ìê¸°ì†Œê°œ",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm resize-none focus:outline-none focus:ring-2 focus:ring-purple-500",rows:2,maxLength:200}),e.jsx("button",{type:"submit",disabled:x||!n.name.trim()||!n.phoneNumber||!n.gender||!n.password||!o,className:"w-full bg-gradient-to-r from-purple-500 to-rose-500 text-white py-3 rounded-xl font-medium hover:from-purple-600 hover:to-rose-600 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:x?"ê°€ì… ì¤‘...":"ğŸ‘» ìœ ë ¹ íšŒì› ìƒì„±"})]})]})]})})}export{a as default};

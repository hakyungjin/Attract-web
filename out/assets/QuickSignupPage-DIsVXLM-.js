import{j as e,s as t,h as l}from"./index-KnChPrwq.js";import{d as r,r as s}from"./vendor-DxrR1XxW.js";import{s as a,K as n,g as o}from"./schools-BXrPHggY.js";import"./supabase-DKAQY1gD.js";function i(){const i=r(),[d,c]=s.useState({name:"",phoneNumber:"",password:"",age:"",gender:"",location:"",bio:"",mbti:"",school:"",height:"",bodyType:"",style:"",religion:"",smoking:"",drinking:""}),[p,u]=s.useState(null),[x,g]=s.useState(""),[m,b]=s.useState(!1),[h,y]=s.useState([]),[f,j]=s.useState(""),[N,v]=s.useState(""),[w,k]=s.useState(""),[C,S]=s.useState([]),T=e=>{const{name:t,value:l}=e.target;c(e=>({...e,[t]:l}))},I=()=>{f.trim()&&!h.includes(f.trim())&&(y([...h,f.trim()]),j(""))};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-pink-50 to-rose-50 py-4 px-4",children:e.jsxs("div",{className:"w-full max-w-md mx-auto",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-purple-600 to-rose-600 bg-clip-text text-transparent mb-1",children:"âš¡ ë¹ ë¥¸ íšŒì›ê°€ì…"}),e.jsx("p",{className:"text-xs text-gray-500",children:"í…ŒìŠ¤íŠ¸ìš© ìœ ë ¹ íšŒì› ìƒì„± (ëª¨ë“  í•„ë“œ)"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"text-sm font-bold text-gray-800",children:"ğŸ‘» ìœ ë ¹ íšŒì› ì •ë³´"}),e.jsx("button",{type:"button",onClick:()=>i("/login"),className:"text-xs text-gray-500 hover:text-gray-700",children:"â† ëŒì•„ê°€ê¸°"})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),d.name.trim())if(!d.phoneNumber||d.phoneNumber.length<13)alert("ì˜¬ë°”ë¥¸ ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");else if(!d.password||d.password.length<4)alert("ë¹„ë°€ë²ˆí˜¸ëŠ” 4ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.");else if(d.gender)if(p){b(!0);try{const e=await(async()=>{if(!p)return null;try{const e=p.name.split(".").pop(),l=`avatars/${Date.now()}_${Math.random().toString(36).substring(7)}.${e}`,{error:r}=await t.storage.from("avatars").upload(l,p,{cacheControl:"3600",upsert:!1});if(r)throw r;const{data:{publicUrl:s}}=t.storage.from("avatars").getPublicUrl(l);return s}catch(o){return null}})();if(!e)return alert("ì´ë¯¸ì§€ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),void b(!1);const r=d.phoneNumber.replace(/[^\d]/g,""),{data:s}=await t.from("users").select("id").eq("phone_number",r).maybeSingle();if(s)return alert("ì´ë¯¸ ë“±ë¡ëœ ì „í™”ë²ˆí˜¸ì…ë‹ˆë‹¤."),void b(!1);const a=await l(d.password),{data:n,error:o}=await t.from("users").insert({phone_number:r,password_hash:a,name:d.name.trim(),age:d.age?parseInt(d.age):null,gender:d.gender,location:d.location.trim()||null,bio:d.bio.trim()||null,mbti:d.mbti.toUpperCase()||null,school:d.school.trim()||null,height:d.height||null,body_type:d.bodyType||null,style:d.style||null,religion:d.religion||null,smoking:d.smoking||null,drinking:d.drinking||null,interests:h.length>0?h:null,profile_image:e,is_ghost:!0,profile_completed:!0,created_at:(new Date).toISOString()}).select().single();if(o)return alert("íšŒì›ê°€ì…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),void b(!1);alert(`íšŒì›ê°€ì… ì™„ë£Œ!\n${d.name}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤!`),c({name:"",phoneNumber:"",password:"",age:"",gender:"",location:"",bio:"",mbti:"",school:"",height:"",bodyType:"",style:"",religion:"",smoking:"",drinking:""}),u(null),g(""),y([])}catch(r){alert("íšŒì›ê°€ì… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{b(!1)}}else alert("í”„ë¡œí•„ ì‚¬ì§„ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.");else alert("ì„±ë³„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");else alert("ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")},className:"space-y-3",children:[e.jsx("div",{className:"flex justify-center mb-2",children:x?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:x,alt:"ë¯¸ë¦¬ë³´ê¸°",className:"w-20 h-20 object-cover rounded-full border-2 border-purple-300"}),e.jsx("button",{type:"button",onClick:()=>{u(null),g("")},className:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-5 h-5 text-xs flex items-center justify-center",children:"âœ•"})]}):e.jsxs("label",{className:"w-20 h-20 bg-purple-50 border-2 border-dashed border-purple-300 rounded-full flex flex-col items-center justify-center cursor-pointer hover:bg-purple-100",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:e=>{const t=e.target.files?.[0];if(!t)return;if(t.size>5242880)return void alert("íŒŒì¼ í¬ê¸°ëŠ” 5MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.");if(!t.type.startsWith("image/"))return void alert("ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.");u(t);const l=new FileReader;l.onloadend=()=>{g(l.result)},l.readAsDataURL(t)},className:"hidden"}),e.jsx("i",{className:"ri-camera-line text-purple-500 text-lg"}),e.jsx("span",{className:"text-[10px] text-purple-600",children:"ì‚¬ì§„*"})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",name:"name",value:d.name,onChange:T,placeholder:"ì´ë¦„ *",className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0}),e.jsx("input",{type:"number",name:"age",value:d.age,onChange:T,placeholder:"ë‚˜ì´",className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500",min:"18",max:"100"})]}),e.jsx("input",{type:"tel",name:"phoneNumber",value:d.phoneNumber,onChange:e=>{const t=(e=>{const t=e.replace(/[^\d]/g,"");return t.length<=3?t:t.length<=7?`${t.slice(0,3)}-${t.slice(3)}`:`${t.slice(0,3)}-${t.slice(3,7)}-${t.slice(7,11)}`})(e.target.value);c(e=>({...e,phoneNumber:t}))},placeholder:"ì „í™”ë²ˆí˜¸ * (010-1234-5678)",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500",maxLength:13,required:!0}),e.jsx("input",{type:"password",name:"password",value:d.password,onChange:T,placeholder:"ë¹„ë°€ë²ˆí˜¸ * (4ì ì´ìƒ)",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500",minLength:4,required:!0}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{type:"button",onClick:()=>c(e=>({...e,gender:"male"})),className:"py-2 rounded-lg text-sm font-medium transition-all "+("male"===d.gender?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:"ë‚¨ì"}),e.jsx("button",{type:"button",onClick:()=>c(e=>({...e,gender:"female"})),className:"py-2 rounded-lg text-sm font-medium transition-all "+("female"===d.gender?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:"ì—¬ì"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"í•™êµ/ì§ì—…"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:w||d.school,onChange:e=>{k(e.target.value),S(a(e.target.value,5))},placeholder:"í•™êµ ë˜ëŠ” ì§ì—… ê²€ìƒ‰",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500"}),C.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-40 overflow-y-auto",children:C.map(t=>e.jsx("button",{type:"button",onClick:()=>{c(e=>({...e,school:t})),k(""),S([])},className:"w-full px-3 py-2 text-left text-sm hover:bg-purple-50 border-b border-gray-100 last:border-b-0",children:t},t))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:N,onChange:e=>{v(e.target.value),c(e=>({...e,location:""}))},className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white appearance-none",children:[e.jsx("option",{value:"",children:"ì‹œ/ë„ ì„ íƒ"}),n.map(t=>e.jsx("option",{value:t.sido,children:t.sido.replace("íŠ¹ë³„ì‹œ","").replace("ê´‘ì—­ì‹œ","").replace("íŠ¹ë³„ìì¹˜ì‹œ","").replace("íŠ¹ë³„ìì¹˜ë„","").replace("ë„","")},t.sido))]}),e.jsx("i",{className:"ri-arrow-down-s-line absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none text-sm"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:d.location&&d.location.split(" ")[1]||"",onChange:e=>c(t=>({...t,location:N?`${N} ${e.target.value}`:""})),className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white appearance-none",disabled:!N,children:[e.jsx("option",{value:"",children:"êµ¬/êµ° ì„ íƒ"}),N&&o(N).map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsx("i",{className:"ri-arrow-down-s-line absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"MBTI"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:["INTJ","INTP","ENTJ","ENTP","INFJ","INFP","ENFJ","ENFP","ISTJ","ISFJ","ESTJ","ESFJ","ISTP","ISFP","ESTP","ESFP"].map(t=>e.jsx("button",{type:"button",onClick:()=>c(e=>({...e,mbti:t})),className:"px-2 py-1 rounded text-xs transition-all "+(d.mbti===t?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"í‚¤"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:["150~155","155~160","160~165","165~170","170~175","175~180","180~185","185~190"].map(t=>e.jsx("button",{type:"button",onClick:()=>c(e=>({...e,height:t})),className:"px-2 py-1 rounded text-xs transition-all "+(d.height===t?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"ì²´í˜•"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:["ë§ˆë¥¸","ë³´í†µ","í†µí†µ","ê·¼ìœ¡ì§ˆ","ê±´ì¥í•œ"].map(t=>e.jsx("button",{type:"button",onClick:()=>c(e=>({...e,bodyType:t})),className:"px-2 py-1 rounded text-xs transition-all "+(d.bodyType===t?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"ìŠ¤íƒ€ì¼"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:["ìºì£¼ì–¼","ìŠ¤í¬í‹°","ëª¨ë˜","í´ë˜ì‹","ìŠ¤íŠ¸ë¦¿","í˜ë¯¸ë‹Œ"].map(t=>e.jsx("button",{type:"button",onClick:()=>c(e=>({...e,style:t})),className:"px-2 py-1 rounded text-xs transition-all "+(d.style===t?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"ì¢…êµ"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:["ë¬´êµ","ê¸°ë…êµ","ì²œì£¼êµ","ë¶ˆêµ","ì›ë¶ˆêµ","ê¸°íƒ€"].map(t=>e.jsx("button",{type:"button",onClick:()=>c(e=>({...e,religion:t})),className:"px-2 py-1 rounded text-xs transition-all "+(d.religion===t?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:t},t))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"í¡ì—°"}),e.jsx("div",{className:"flex gap-1",children:["ë¹„í¡ì—°","í¡ì—°"].map(t=>e.jsx("button",{type:"button",onClick:()=>c(e=>({...e,smoking:t})),className:"px-2 py-1 rounded text-xs flex-1 transition-all "+(d.smoking===t?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"ìŒì£¼"}),e.jsx("div",{className:"flex gap-1",children:["ì•ˆ ë§ˆì‹¬","ê°€ë”","ìì£¼"].map(t=>e.jsx("button",{type:"button",onClick:()=>c(e=>({...e,drinking:t})),className:"px-2 py-1 rounded text-xs flex-1 transition-all "+(d.drinking===t?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:t},t))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"ê´€ì‹¬ì‚¬"}),e.jsxs("div",{className:"flex gap-1 mb-1",children:[e.jsx("input",{type:"text",value:f,onChange:e=>j(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),I())},placeholder:"ê´€ì‹¬ì‚¬ ì…ë ¥ í›„ ì¶”ê°€",className:"flex-1 px-2 py-1.5 border border-gray-200 rounded text-xs focus:outline-none focus:ring-2 focus:ring-purple-500"}),e.jsx("button",{type:"button",onClick:I,className:"px-3 py-1.5 bg-purple-500 text-white rounded text-xs hover:bg-purple-600",children:"ì¶”ê°€"})]}),h.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:h.map((t,l)=>e.jsxs("span",{className:"bg-purple-100 text-purple-700 px-2 py-0.5 rounded-full text-xs flex items-center gap-1",children:[t," ",e.jsx("button",{type:"button",onClick:()=>y(h.filter((e,t)=>t!==l)),className:"text-purple-500 hover:text-purple-700",children:"Ã—"})]},l))})]}),e.jsx("textarea",{name:"bio",value:d.bio,onChange:T,placeholder:"ìê¸°ì†Œê°œ",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm resize-none focus:outline-none focus:ring-2 focus:ring-purple-500",rows:2,maxLength:200}),e.jsx("button",{type:"submit",disabled:m||!d.name.trim()||!d.phoneNumber||!d.gender||!d.password||!p,className:"w-full bg-gradient-to-r from-purple-500 to-rose-500 text-white py-3 rounded-xl font-medium hover:from-purple-600 hover:to-rose-600 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:m?"ê°€ì… ì¤‘...":"ğŸ‘» ìœ ë ¹ íšŒì› ìƒì„±"})]})]})]})})}export{i as default};

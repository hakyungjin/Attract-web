import{u as e,s as t,j as s}from"./index-D-HdNcYp.js";import{e as r,r as a}from"./vendor-DkI5JUVe.js";import"./supabase-DEy9n1le.js";function i(){const i=r(),{user:l}=e(),[n,c]=a.useState([]),[d,x]=a.useState(!0);a.useEffect(()=>{l?.id&&o()},[l?.id]);const o=async()=>{try{if(!l?.id)return c([]),void x(!1);const{data:e,error:s}=await t.from("notifications").select("*").order("created_at",{ascending:!1});if(s)return c([]),void x(!1);const r=(e||[]).map(e=>({id:e.id,type:e.type,message:e.message||e.content||"",time:m(e.created_at),isRead:e.read||!1}));c(r)}catch(e){c([])}finally{x(!1)}},m=e=>{const t=new Date(e),s=(new Date).getTime()-t.getTime(),r=Math.floor(s/6e4),a=Math.floor(s/36e5),i=Math.floor(s/864e5);return r<1?"방금 전":r<60?`${r}분 전`:a<24?`${a}시간 전`:i<7?`${i}일 전`:t.toLocaleDateString("ko-KR")},f=e=>{switch(e){case"like":return"ri-heart-fill text-red-500";case"match":return"ri-user-heart-fill text-pink-500";case"message":return"ri-message-fill text-blue-500";case"community":return"ri-chat-3-fill text-green-500";default:return"ri-notification-fill text-gray-500"}},h=n.filter(e=>!e.isRead).length;return s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx("header",{className:"fixed top-0 left-0 right-0 bg-white border-b border-gray-200 z-40 pt-[env(safe-area-inset-top)]",children:s.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("button",{onClick:()=>i(-1),className:"w-8 h-8 flex items-center justify-center cursor-pointer",children:s.jsx("div",{className:"w-5 h-5 flex items-center justify-center",children:s.jsx("i",{className:"ri-arrow-left-line text-gray-700 text-xl"})})}),s.jsx("h1",{className:"text-lg font-bold",children:"알림"}),h>0&&s.jsx("span",{className:"bg-red-500 text-white text-xs px-2 py-0.5 rounded-full",children:h})]}),n.length>0&&s.jsx("button",{onClick:()=>{c(e=>e.map(e=>({...e,isRead:!0})))},className:"text-sm text-gray-600 hover:text-gray-800 cursor-pointer whitespace-nowrap",children:"모두 읽음"})]})}),s.jsx("main",{className:"pb-6",style:{paddingTop:"calc(64px + env(safe-area-inset-top))",paddingBottom:"calc(24px + env(safe-area-inset-bottom))"},children:d?s.jsx("div",{className:"flex flex-col items-center justify-center py-20",children:s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-gray-200 border-t-blue-500 rounded-full"})}):0===n.length?s.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[s.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:s.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:s.jsx("i",{className:"ri-notification-off-line text-4xl text-gray-300"})})}),s.jsx("p",{className:"text-gray-500 text-center",children:"새로운 알림이 없습니다"})]}):s.jsx("div",{className:"divide-y divide-gray-100",children:n.map(e=>s.jsx("div",{className:"px-4 py-4 hover:bg-gray-50 transition-colors cursor-pointer relative "+(e.isRead?"bg-white":"bg-blue-50"),children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"w-10 h-10 flex items-center justify-center flex-shrink-0",children:s.jsx("i",{className:f(e.type)+" text-2xl"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm "+(e.isRead?"text-gray-700":"font-medium text-gray-900"),children:e.message}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.time})]}),s.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[!e.isRead&&s.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),s.jsx("button",{onClick:t=>{var s;t.stopPropagation(),s=e.id,c(e=>e.filter(e=>e.id!==s))},className:"w-6 h-6 flex items-center justify-center cursor-pointer hover:bg-gray-200 rounded-full transition-colors",children:s.jsx("div",{className:"w-4 h-4 flex items-center justify-center",children:s.jsx("i",{className:"ri-close-line text-gray-400"})})})]})]})},e.id))})})]})}export{i as default};

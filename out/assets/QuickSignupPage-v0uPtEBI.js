import{j as e,f as t,h as s,r,s as a,a as l,g as n}from"./index-0bpRGtBK.js";import{u as i,r as o}from"./vendor-DiTsd9F_.js";import{s as d,K as c,g as p}from"./schools-BXrPHggY.js";import{s as x,v as u}from"./ssodaaSmsService-DF4U11Tl.js";import"./supabase-F6L96wRu.js";function g(){const g=i(),[m,b]=o.useState({name:"",phoneNumber:"",password:"",age:"",gender:"",location:"",bio:"",mbti:"",school:"",height:"",bodyType:"",style:"",religion:"",smoking:"",drinking:""}),[h,y]=o.useState(null),[f,j]=o.useState(""),[N,v]=o.useState(!1),[w,k]=o.useState([]),[C,S]=o.useState(""),[T,$]=o.useState(""),[I,P]=o.useState(""),[E,F]=o.useState([]),[_,J]=o.useState(""),[D,L]=o.useState(!1),[U,q]=o.useState(!1),[z,B]=o.useState(!1),[M,K]=o.useState(!1),R=e=>{const{name:t,value:s}=e.target;b(e=>({...e,[t]:s}))},A=()=>{C.trim()&&!w.includes(C.trim())&&(k([...w,C.trim()]),S(""))};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-pink-50 to-rose-50 py-4 px-4",children:e.jsxs("div",{className:"w-full max-w-md mx-auto",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-purple-600 to-rose-600 bg-clip-text text-transparent mb-1",children:"âš¡ ë¹ ë¥¸ íšŒì›ê°€ì…"}),e.jsx("p",{className:"text-xs text-gray-500",children:"í…ŒìŠ¤íŠ¸ìš© ìœ ë ¹ íšŒì› ìƒì„± (ëª¨ë“  í•„ë“œ)"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"text-sm font-bold text-gray-800",children:"ğŸ‘» ìœ ë ¹ íšŒì› ì •ë³´"}),e.jsx("button",{type:"button",onClick:()=>g("/login"),className:"text-xs text-gray-500 hover:text-gray-700",children:"â† ëŒì•„ê°€ê¸°"})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),m.name.trim())if(!m.phoneNumber||m.phoneNumber.length<13)alert("ì˜¬ë°”ë¥¸ ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");else if(!m.password||m.password.length<4)alert("ë¹„ë°€ë²ˆí˜¸ëŠ” 4ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.");else if(m.gender)if(h){v(!0);try{const e=await(async()=>{if(!h)return null;try{const e=h.name.split(".").pop(),t=`${Date.now()}_${Math.random().toString(36).substring(7)}.${e}`,s=r(a,`avatars/${t}`);return await l(s,h),await n(s)}catch(p){return null}})();if(!e)return alert("ì´ë¯¸ì§€ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),void v(!1);const i=m.phoneNumber.replace(/[^\d]/g,""),{user:o}=await t.users.findUserByPhoneNumber(i);if(o)return alert("ì´ë¯¸ ë“±ë¡ëœ ì „í™”ë²ˆí˜¸ì…ë‹ˆë‹¤."),void v(!1);const d=await s(m.password),{user:c,error:p}=await t.users.createUser({firebase_uid:"",phone_number:i,password_hash:d,name:m.name.trim(),age:m.age?parseInt(m.age):void 0,gender:m.gender,location:m.location.trim()||void 0,bio:m.bio.trim()||void 0,mbti:m.mbti.toUpperCase()||void 0,school:m.school.trim()||void 0,height:m.height||void 0,body_type:m.bodyType||void 0,style:m.style||void 0,religion:m.religion||void 0,smoking:m.smoking||void 0,drinking:m.drinking||void 0,interests:w.length>0?w:void 0,profile_image:e,is_ghost:!0,profile_completed:!0,created_at:(new Date).toISOString()});if(p)return alert("íšŒì›ê°€ì…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),void v(!1);alert(`íšŒì›ê°€ì… ì™„ë£Œ!\n${m.name}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤!`),b({name:"",phoneNumber:"",password:"",age:"",gender:"",location:"",bio:"",mbti:"",school:"",height:"",bodyType:"",style:"",religion:"",smoking:"",drinking:""}),y(null),j(""),k([])}catch(i){alert("íšŒì›ê°€ì… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{v(!1)}}else alert("í”„ë¡œí•„ ì‚¬ì§„ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.");else alert("ì„±ë³„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");else alert("ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")},className:"space-y-3",children:[e.jsx("div",{className:"flex justify-center mb-2",children:f?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:f,alt:"ë¯¸ë¦¬ë³´ê¸°",className:"w-20 h-20 object-cover rounded-full border-2 border-purple-300"}),e.jsx("button",{type:"button",onClick:()=>{y(null),j("")},className:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-5 h-5 text-xs flex items-center justify-center",children:"âœ•"})]}):e.jsxs("label",{className:"w-20 h-20 bg-purple-50 border-2 border-dashed border-purple-300 rounded-full flex flex-col items-center justify-center cursor-pointer hover:bg-purple-100",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:e=>{const t=e.target.files?.[0];if(!t)return;if(t.size>5242880)return void alert("íŒŒì¼ í¬ê¸°ëŠ” 5MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.");if(!t.type.startsWith("image/"))return void alert("ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.");y(t);const s=new FileReader;s.onloadend=()=>{j(s.result)},s.readAsDataURL(t)},className:"hidden"}),e.jsx("i",{className:"ri-camera-line text-purple-500 text-lg"}),e.jsx("span",{className:"text-[10px] text-purple-600",children:"ì‚¬ì§„*"})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",name:"name",value:m.name,onChange:R,placeholder:"ì´ë¦„ *",className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0}),e.jsx("input",{type:"number",name:"age",value:m.age,onChange:R,placeholder:"ë‚˜ì´",className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500",min:"18",max:"100"})]}),e.jsx("input",{type:"tel",name:"phoneNumber",value:m.phoneNumber,onChange:e=>{const t=(e=>{const t=e.replace(/[^\d]/g,"");return t.length<=3?t:t.length<=7?`${t.slice(0,3)}-${t.slice(3)}`:`${t.slice(0,3)}-${t.slice(3,7)}-${t.slice(7,11)}`})(e.target.value);b(e=>({...e,phoneNumber:t}))},placeholder:"ì „í™”ë²ˆí˜¸ * (010-1234-5678)",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500",maxLength:13,required:!0}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:async()=>{if(!m.phoneNumber||m.phoneNumber.length<13)alert("ì˜¬ë°”ë¥¸ ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");else{B(!0);try{await x(m.phoneNumber)?(L(!0),alert("ì¸ì¦ë²ˆí˜¸ê°€ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤. 3ë¶„ ë‚´ì— ì…ë ¥í•´ì£¼ì„¸ìš”.")):alert("ì¸ì¦ë²ˆí˜¸ ë°œì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.")}catch(e){alert(`ì¸ì¦ë²ˆí˜¸ ë°œì†¡ ì‹¤íŒ¨: ${e.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}`)}finally{B(!1)}}},disabled:!m.phoneNumber||m.phoneNumber.length<13||z,className:"px-3 py-1.5 bg-gray-100 text-gray-600 rounded-lg text-xs font-medium hover:bg-gray-200 disabled:bg-gray-50 disabled:text-gray-400 disabled:cursor-not-allowed",children:z?"ë°œì†¡ì¤‘...":"ğŸ“± ì¸ì¦ë²ˆí˜¸ í…ŒìŠ¤íŠ¸"}),D&&!U&&e.jsxs("div",{className:"flex gap-1 flex-1",children:[e.jsx("input",{type:"text",value:_,onChange:e=>J(e.target.value.replace(/[^\d]/g,"").slice(0,6)),placeholder:"ì¸ì¦ë²ˆí˜¸",className:"flex-1 px-2 py-1.5 border border-gray-200 rounded text-xs focus:outline-none focus:ring-1 focus:ring-purple-500",maxLength:6}),e.jsx("button",{type:"button",onClick:async()=>{if(_&&6===_.length){K(!0);try{const e=await u(m.phoneNumber,_);q(e)}catch(e){alert(`ì¸ì¦ í™•ì¸ ì‹¤íŒ¨: ${e.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}`)}finally{K(!1)}}else alert("6ìë¦¬ ì¸ì¦ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")},disabled:!_||6!==_.length||M,className:"px-2 py-1.5 bg-green-500 text-white rounded text-xs hover:bg-green-600 disabled:bg-gray-300",children:"í™•ì¸"})]}),U&&e.jsx("span",{className:"text-xs text-green-600",children:"âœ“ ì¸ì¦ì™„ë£Œ"})]}),e.jsx("input",{type:"password",name:"password",value:m.password,onChange:R,placeholder:"ë¹„ë°€ë²ˆí˜¸ * (4ì ì´ìƒ)",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500",minLength:4,required:!0}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{type:"button",onClick:()=>b(e=>({...e,gender:"male"})),className:"py-2 rounded-lg text-sm font-medium transition-all "+("male"===m.gender?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:"ë‚¨ì"}),e.jsx("button",{type:"button",onClick:()=>b(e=>({...e,gender:"female"})),className:"py-2 rounded-lg text-sm font-medium transition-all "+("female"===m.gender?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:"ì—¬ì"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"í•™êµ/ì§ì—…"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:I||m.school,onChange:e=>{P(e.target.value),F(d(e.target.value,5))},placeholder:"í•™êµ ë˜ëŠ” ì§ì—… ê²€ìƒ‰",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500"}),E.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-40 overflow-y-auto",children:E.map(t=>e.jsx("button",{type:"button",onClick:()=>{b(e=>({...e,school:t})),P(""),F([])},className:"w-full px-3 py-2 text-left text-sm hover:bg-purple-50 border-b border-gray-100 last:border-b-0",children:t},t))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:T,onChange:e=>{$(e.target.value),b(e=>({...e,location:""}))},className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white appearance-none",children:[e.jsx("option",{value:"",children:"ì‹œ/ë„ ì„ íƒ"}),c.map(t=>e.jsx("option",{value:t.sido,children:t.sido.replace("íŠ¹ë³„ì‹œ","").replace("ê´‘ì—­ì‹œ","").replace("íŠ¹ë³„ìì¹˜ì‹œ","").replace("íŠ¹ë³„ìì¹˜ë„","").replace("ë„","")},t.sido))]}),e.jsx("i",{className:"ri-arrow-down-s-line absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none text-sm"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:m.location&&m.location.split(" ")[1]||"",onChange:e=>b(t=>({...t,location:T?`${T} ${e.target.value}`:""})),className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white appearance-none",disabled:!T,children:[e.jsx("option",{value:"",children:"êµ¬/êµ° ì„ íƒ"}),T&&p(T).map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsx("i",{className:"ri-arrow-down-s-line absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"MBTI"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:["INTJ","INTP","ENTJ","ENTP","INFJ","INFP","ENFJ","ENFP","ISTJ","ISFJ","ESTJ","ESFJ","ISTP","ISFP","ESTP","ESFP"].map(t=>e.jsx("button",{type:"button",onClick:()=>b(e=>({...e,mbti:t})),className:"px-2 py-1 rounded text-xs transition-all "+(m.mbti===t?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"í‚¤"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:["150~155","155~160","160~165","165~170","170~175","175~180","180~185","185~190"].map(t=>e.jsx("button",{type:"button",onClick:()=>b(e=>({...e,height:t})),className:"px-2 py-1 rounded text-xs transition-all "+(m.height===t?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"ì²´í˜•"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:["ë§ˆë¥¸","ë³´í†µ","í†µí†µ","ê·¼ìœ¡ì§ˆ","ê±´ì¥í•œ"].map(t=>e.jsx("button",{type:"button",onClick:()=>b(e=>({...e,bodyType:t})),className:"px-2 py-1 rounded text-xs transition-all "+(m.bodyType===t?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"ìŠ¤íƒ€ì¼"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:["ìºì£¼ì–¼","ìŠ¤í¬í‹°","ëª¨ë˜","í´ë˜ì‹","ìŠ¤íŠ¸ë¦¿","í˜ë¯¸ë‹Œ"].map(t=>e.jsx("button",{type:"button",onClick:()=>b(e=>({...e,style:t})),className:"px-2 py-1 rounded text-xs transition-all "+(m.style===t?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"ì¢…êµ"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:["ë¬´êµ","ê¸°ë…êµ","ì²œì£¼êµ","ë¶ˆêµ","ì›ë¶ˆêµ","ê¸°íƒ€"].map(t=>e.jsx("button",{type:"button",onClick:()=>b(e=>({...e,religion:t})),className:"px-2 py-1 rounded text-xs transition-all "+(m.religion===t?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:t},t))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"í¡ì—°"}),e.jsx("div",{className:"flex gap-1",children:["ë¹„í¡ì—°","í¡ì—°"].map(t=>e.jsx("button",{type:"button",onClick:()=>b(e=>({...e,smoking:t})),className:"px-2 py-1 rounded text-xs flex-1 transition-all "+(m.smoking===t?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"ìŒì£¼"}),e.jsx("div",{className:"flex gap-1",children:["ì•ˆ ë§ˆì‹¬","ê°€ë”","ìì£¼"].map(t=>e.jsx("button",{type:"button",onClick:()=>b(e=>({...e,drinking:t})),className:"px-2 py-1 rounded text-xs flex-1 transition-all "+(m.drinking===t?"bg-purple-500 text-white":"bg-gray-100 text-gray-600"),children:t},t))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"ê´€ì‹¬ì‚¬"}),e.jsxs("div",{className:"flex gap-1 mb-1",children:[e.jsx("input",{type:"text",value:C,onChange:e=>S(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),A())},placeholder:"ê´€ì‹¬ì‚¬ ì…ë ¥ í›„ ì¶”ê°€",className:"flex-1 px-2 py-1.5 border border-gray-200 rounded text-xs focus:outline-none focus:ring-2 focus:ring-purple-500"}),e.jsx("button",{type:"button",onClick:A,className:"px-3 py-1.5 bg-purple-500 text-white rounded text-xs hover:bg-purple-600",children:"ì¶”ê°€"})]}),w.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:w.map((t,s)=>e.jsxs("span",{className:"bg-purple-100 text-purple-700 px-2 py-0.5 rounded-full text-xs flex items-center gap-1",children:[t," ",e.jsx("button",{type:"button",onClick:()=>k(w.filter((e,t)=>t!==s)),className:"text-purple-500 hover:text-purple-700",children:"Ã—"})]},s))})]}),e.jsx("textarea",{name:"bio",value:m.bio,onChange:R,placeholder:"ìê¸°ì†Œê°œ",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm resize-none focus:outline-none focus:ring-2 focus:ring-purple-500",rows:2,maxLength:200}),e.jsx("button",{type:"submit",disabled:N||!m.name.trim()||!m.phoneNumber||!m.gender||!m.password||!h,className:"w-full bg-gradient-to-r from-purple-500 to-rose-500 text-white py-3 rounded-xl font-medium hover:from-purple-600 hover:to-rose-600 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:N?"ê°€ì… ì¤‘...":"ğŸ‘» ìœ ë ¹ íšŒì› ìƒì„±"})]})]})]})})}export{g as default};

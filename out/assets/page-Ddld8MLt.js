import{j as e,s}from"./index-MGgYOwZh.js";import{d as l,e as t,r as o}from"./vendor-DxrR1XxW.js";import"./supabase-DKAQY1gD.js";function a(){const a=l(),r=t(),[n,i]=o.useState({phone_number:"",name:"",age:20,gender:"male",location:"",bio:"",mbti:"",school:"",job:"",height:"160~165",body_type:"보통",style:"캐주얼",religion:"무교",smoking:"비흡연",drinking:"가끔",interests:[],profile_image:""}),[c,d]=o.useState(""),[x,u]=o.useState(!1),[m,h]=o.useState(!1),[b,p]=o.useState(""),[g,y]=o.useState(!1);o.useEffect(()=>{const e=r.state?.phoneNumber;if(e){(async()=>{const{data:l}=await s.from("users").select("*").eq("phone_number",e).single();l&&i(e=>({...e,phone_number:l.phone_number,name:l.name,age:l.age||20,gender:l.gender||"male",location:l.location||"",bio:l.bio||"",mbti:l.mbti||"",school:l.school||"",job:l.job||""}))})()}},[r]);const f=()=>{c.trim()&&!n.interests.includes(c)&&(i(e=>({...e,interests:[...e.interests,c]})),d(""))};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-cyan-50 via-sky-50 to-blue-50 py-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"프로필 완성"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"추가 정보를 입력하여 더 나은 매칭을 받으세요"})]}),e.jsxs("div",{className:"bg-white rounded-3xl shadow-xl p-8 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"MBTI"}),e.jsx("input",{type:"text",value:n.mbti,onChange:e=>i(s=>({...s,mbti:e.target.value.toUpperCase()})),placeholder:"예: ENFP",maxLength:4,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-cyan-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"지역"}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{type:"button",onClick:()=>u(!0),className:"flex-1 px-4 py-3 border-2 border-gray-200 rounded-xl bg-white text-gray-700 hover:border-cyan-500 transition-colors cursor-pointer",children:n.location||"지역 선택"})}),x&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl p-6 max-w-md w-full max-h-96 overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"지역 선택"}),e.jsx("div",{className:"space-y-2 max-h-72 overflow-y-auto",children:Object.entries({"서울":["강남구","강동구","강북구","강서구","관악구","광진구","구로구","금천구","노원구","도봉구","동대문구","동작구","마포구","서대문구","서초구","성동구","성북구","송파구","양천구","영등포구","용산구","은평구","종로구","중구","중랑구"],"인천":["계양구","남동구","동구","미추홀구","부평구","서구","연수구","중구","강화군","옹진군"],"부산":["강서구","금정구","남구","동구","동래구","부산진구","북구","사상구","사하구","서구","수영구","연제구","영도구","중구","해운대구","기장군"],"대구":["남구","달서구","동구","북구","서구","수성구","중구","달성군"],"대전":["대덕구","동구","서구","유성구","중구"],"광주":["광산구","남구","동구","북구","서구"],"울산":["남구","동구","북구","중구","울주군"],"경기":["고양시","과천시","광명시","광주시","구리시","군포시","김포시","남양주시","동두천시","부천시","성남시","수원시","시흥시","안산시","안성시","안양시","양주시","여주시","오산시","용인시","의왕시","의정부시","이천시","파주시","평택시","포천시","하남시","화성시"],"강원":["강릉시","동해시","삼척시","속초시","원주시","춘천시","태백시","고성군","양구군","양양군","영월군","인제군","정선군","철원군","평창군","홍천군","화천군","횡성군"]}).map(([s,l])=>e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-800 py-2",children:s}),e.jsx("div",{className:"grid grid-cols-2 gap-2 ml-2",children:l.slice(0,10).map(l=>e.jsx("button",{onClick:()=>((e,s)=>{i(l=>({...l,location:`${e} ${s}`})),u(!1)})(s,l),className:"text-left px-3 py-2 bg-gray-100 hover:bg-cyan-200 rounded-lg text-sm transition-colors cursor-pointer",children:l},l))})]},s))}),e.jsx("button",{onClick:()=>u(!1),className:"w-full mt-4 px-4 py-3 bg-gray-200 rounded-xl cursor-pointer",children:"닫기"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"자기소개"}),e.jsx("textarea",{value:n.bio,onChange:e=>i(s=>({...s,bio:e.target.value})),placeholder:"자신을 소개해주세요...",maxLength:200,rows:4,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-cyan-500 resize-none"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[n.bio.length,"/200"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"학교"}),e.jsx("input",{type:"text",value:n.school,onChange:e=>i(s=>({...s,school:e.target.value})),placeholder:"학교명",maxLength:50,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-cyan-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"직업"}),e.jsx("input",{type:"text",value:n.job,onChange:e=>i(s=>({...s,job:e.target.value})),placeholder:"직업",maxLength:50,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-cyan-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"키"}),e.jsxs("select",{value:n.height,onChange:e=>i(s=>({...s,height:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"150~155",children:"150~155"}),e.jsx("option",{value:"155~160",children:"155~160"}),e.jsx("option",{value:"160~165",children:"160~165"}),e.jsx("option",{value:"165~170",children:"165~170"}),e.jsx("option",{value:"170~175",children:"170~175"}),e.jsx("option",{value:"175~180",children:"175~180"}),e.jsx("option",{value:"180~185",children:"180~185"}),e.jsx("option",{value:"185+",children:"185+"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"체형"}),e.jsxs("select",{value:n.body_type,onChange:e=>i(s=>({...s,body_type:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"마름",children:"마름"}),e.jsx("option",{value:"보통",children:"보통"}),e.jsx("option",{value:"근육질",children:"근육질"}),e.jsx("option",{value:"통통",children:"통통"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"스타일"}),e.jsxs("select",{value:n.style,onChange:e=>i(s=>({...s,style:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"캐주얼",children:"캐주얼"}),e.jsx("option",{value:"포멀",children:"포멀"}),e.jsx("option",{value:"스포츠",children:"스포츠"}),e.jsx("option",{value:"클래식",children:"클래식"}),e.jsx("option",{value:"트렌디",children:"트렌디"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"종교"}),e.jsxs("select",{value:n.religion,onChange:e=>i(s=>({...s,religion:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"무교",children:"무교"}),e.jsx("option",{value:"기독교",children:"기독교"}),e.jsx("option",{value:"천주교",children:"천주교"}),e.jsx("option",{value:"불교",children:"불교"}),e.jsx("option",{value:"이슬람",children:"이슬람"}),e.jsx("option",{value:"기타",children:"기타"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"흡연"}),e.jsxs("select",{value:n.smoking,onChange:e=>i(s=>({...s,smoking:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"비흡연",children:"비흡연"}),e.jsx("option",{value:"흡연",children:"흡연"}),e.jsx("option",{value:"가끔",children:"가끔"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"음주"}),e.jsxs("select",{value:n.drinking,onChange:e=>i(s=>({...s,drinking:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"안함",children:"안함"}),e.jsx("option",{value:"가끔",children:"가끔"}),e.jsx("option",{value:"자주",children:"자주"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"관심사"}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("input",{type:"text",value:c,onChange:e=>d(e.target.value),onKeyPress:e=>"Enter"===e.key&&f(),placeholder:"관심사 입력",maxLength:20,className:"flex-1 px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-cyan-500"}),e.jsx("button",{onClick:f,className:"px-4 py-3 bg-cyan-500 text-white rounded-xl hover:bg-cyan-600 transition-colors cursor-pointer whitespace-nowrap font-semibold",children:"추가"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.interests.map((s,l)=>e.jsxs("div",{className:"flex items-center gap-2 bg-cyan-100 text-cyan-800 px-3 py-2 rounded-full text-sm",children:[s,e.jsx("button",{onClick:()=>(e=>{i(s=>({...s,interests:s.interests.filter((s,l)=>l!==e)}))})(l),className:"text-cyan-600 hover:text-cyan-800 cursor-pointer",children:"×"})]},l))})]}),e.jsxs("div",{className:"text-center pt-6 border-t border-gray-100",children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-800 mb-4",children:["프로필 사진 ",e.jsx("span",{className:"text-red-500",children:"*"})," (필수)"]}),e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"얼굴이 잘 나온 사진을 업로드해주세요"}),e.jsxs("div",{className:"relative inline-block mb-4",children:[g&&e.jsx("div",{className:"absolute inset-0 bg-black/50 rounded-full flex items-center justify-center z-10",children:e.jsx("i",{className:"ri-loader-4-line text-white text-2xl animate-spin"})}),e.jsx("img",{src:b||n.profile_image||"https://readdy.ai/api/search-image?query=minimalist%20silhouette%20profile%20avatar%20icon%20on%20clean%20white%20background%20simple%20modern%20design%20professional%20business%20style%20neutral%20gray%20color%20scheme%20front%20facing%20head%20and%20shoulders%20portrait%20clean%20lines%20vector%20style%20illustration&width=300&height=300&seq=default-avatar&orientation=squarish",alt:"프로필",className:"w-32 h-32 rounded-full object-cover border-4 border-cyan-200",onError:e=>{e.target.src="https://readdy.ai/api/search-image?query=minimalist%20silhouette%20profile%20avatar%20icon%20on%20clean%20white%20background%20simple%20modern%20design%20professional%20business%20style%20neutral%20gray%20color%20scheme%20front%20facing%20head%20and%20shoulders%20portrait%20clean%20lines%20vector%20style%20illustration&width=300&height=300&seq=default-avatar&orientation=squarish"}}),e.jsx("input",{type:"file",id:"profile-image-upload",accept:"image/*",onChange:async e=>{const l=e.target.files?.[0];if(!l)return;if(!["image/jpeg","image/jpg","image/png","image/webp","image/gif"].includes(l.type))return void alert("JPG, PNG, WEBP, GIF 형식의 이미지만 업로드 가능합니다.");if(l.size>5242880)alert("이미지 크기는 5MB 이하여야 합니다.");else{y(!0);try{const e=`profile_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,{error:t,data:o}=await s.storage.from("profile-images").upload(e,l,{cacheControl:"3600",upsert:!1});if(t){let e=t.message||"알 수 없는 오류";return e.includes("Bucket not found")?e='⚠️ Supabase Storage가 제대로 설정되지 않았습니다.\n관리자에게 문의해주세요.\n\n기술 정보: "user-profiles" bucket이 없습니다.':(e.includes("401")||e.includes("Unauthorized"))&&(e="⚠️ 인증 오류: Supabase 설정을 확인해주세요."),void alert("이미지 업로드 실패: "+e)}p(`${"https://ytffobltrwkgxiedorsd.supabase.co"}/storage/v1/object/public/profile-images/${e}`),alert("이미지가 업로드되었습니다!")}catch(t){alert("업로드 중 오류: "+t.message)}finally{y(!1)}}},disabled:g,className:"hidden"}),e.jsx("label",{htmlFor:"profile-image-upload",className:"absolute bottom-0 right-0 w-10 h-10 bg-gradient-to-r from-cyan-500 to-blue-600 text-white rounded-full flex items-center justify-center shadow-lg transition-all cursor-pointer "+(g?"opacity-50 cursor-not-allowed":"hover:from-cyan-600 hover:to-blue-700"),children:e.jsx("i",{className:"ri-camera-line"})})]}),b||n.profile_image?e.jsx("p",{className:"text-sm text-green-500 font-semibold",children:"✓ 프로필 사진 완료"}):e.jsx("p",{className:"text-sm text-red-500 font-semibold",children:"프로필 사진을 업로드해주세요"})]}),e.jsxs("div",{className:"flex gap-3 pt-6",children:[e.jsx("button",{onClick:()=>a("/"),className:"flex-1 px-4 py-3 border-2 border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors cursor-pointer font-semibold",children:"나중에"}),e.jsx("button",{onClick:async()=>{if(b||n.profile_image){h(!0);try{const{error:e}=await s.from("users").update({mbti:n.mbti,location:n.location,bio:n.bio,school:n.school,job:n.job,height:n.height,body_type:n.body_type,style:n.style,religion:n.religion,smoking:n.smoking,drinking:n.drinking,interests:n.interests,profile_image:b||n.profile_image,profile_completed:!0}).eq("phone_number",n.phone_number);if(e)return void alert("프로필 저장 실패: "+e.message);alert("프로필이 완성되었습니다!"),a("/")}catch(e){alert("저장 중 오류: "+e.message)}finally{h(!1)}}else alert("프로필 사진을 업로드해주세요. (필수)")},disabled:m,className:"flex-1 px-4 py-3 bg-gradient-to-r from-cyan-500 to-blue-500 text-white rounded-xl hover:from-cyan-600 hover:to-blue-600 transition-colors disabled:opacity-50 cursor-pointer font-semibold",children:m?"저장 중...":"완성"})]})]})]})})}export{a as default};

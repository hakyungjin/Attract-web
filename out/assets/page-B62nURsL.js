import{s as e,u as s,j as t,l as r}from"./index-C5YiMSK-.js";import{d as a,e as i,r as l}from"./vendor-DxrR1XxW.js";import{a as n}from"./avatarUtils-Bwd0bNSt.js";import"./supabase-DKAQY1gD.js";const c=async(s,t)=>{try{const{data:r,error:a}=await e.functions.invoke("send-push",{body:{userId:s,title:t.title,body:t.body,data:t.data||{}}});return a?{success:!1,error:a}:{success:!0,result:r}}catch(r){return{success:!1,error:r}}},o={INTJ:{ENFP:95,ENTP:90,INFJ:85,INFP:85,ENTJ:80,INTP:80,ENFJ:75,ISTJ:70,ISFJ:65,ESTJ:65,ESFJ:60,ISTP:60,ISFP:55,ESTP:55,ESFP:50,INTJ:75},INTP:{ENTJ:95,ENFJ:90,INTJ:85,INFJ:85,ENTP:80,INFP:75,ENFP:70,ISTJ:65,ISTP:65,ESTJ:60,ISFJ:60,ESTP:55,ESFJ:55,ISFP:50,ESFP:50,INTP:75},ENTJ:{INTP:95,INFP:90,INTJ:85,ENFP:85,ENTP:80,INFJ:75,ENFJ:70,ISTP:65,ISTJ:65,ESTP:60,ESTJ:60,ISFP:55,ISFJ:55,ESFP:50,ESFJ:50,ENTJ:70},ENTP:{INFJ:95,INTJ:90,ENFP:85,INFP:85,ENTJ:80,INTP:80,ENFJ:75,ISFJ:70,ISTJ:65,ESFJ:65,ESTJ:60,ISFP:60,ISTP:55,ESFP:55,ESTP:50,ENTP:75},INFJ:{ENTP:95,ENFP:90,INFP:85,INTJ:85,ENFJ:80,INTP:80,ENTJ:75,ISFP:70,ISTP:65,ESFP:65,ESTP:60,ISFJ:60,ISTJ:55,ESFJ:55,ESTJ:50,INFJ:75},INFP:{ENFJ:95,ENTJ:90,INFJ:85,ENFP:85,ENTP:80,INTJ:75,INTP:75,ISFJ:70,ESFJ:65,ISTJ:65,ESTJ:60,ISFP:60,ISTP:55,ESFP:55,ESTP:50,INFP:75},ENFJ:{INFP:95,INTP:90,ENFP:85,INFJ:85,ENTJ:75,ENTP:75,ISFP:70,ISFJ:70,ESFJ:65,ISTJ:65,ESTJ:60,ISTP:60,ESFP:55,ESTP:55,INTJ:70,ENFJ:75},ENFP:{INTJ:95,INFJ:90,ENFJ:85,INFP:85,ENTP:80,ENTJ:80,INTP:75,ESFJ:70,ISFJ:70,ESFP:65,ISFP:65,ESTJ:60,ISTJ:60,ESTP:55,ISTP:55,ENFP:75},ISTJ:{ESFP:85,ESTP:80,ISFP:75,ISTP:75,ESTJ:75,ISFJ:70,ESFJ:70,INTJ:65,ENTJ:65,ENTP:60,INTP:60,ENFP:55,INFP:55,ENFJ:55,INFJ:50,ISTJ:70},ISFJ:{ESFP:90,ESTP:85,ENFP:80,ENTP:75,INFP:75,ESFJ:75,ISFP:70,ESTJ:70,ISTJ:70,ISTP:65,ENFJ:65,INFJ:60,ENTJ:55,INTJ:55,INTP:55,ISFJ:70},ESTJ:{ISFP:85,ISTP:80,ESFP:75,ESTP:75,ISTJ:75,ESFJ:70,ISFJ:70,ENTJ:65,INTJ:65,INTP:60,ENTP:60,INFP:55,ENFP:55,INFJ:55,ENFJ:50,ESTJ:70},ESFJ:{ISFP:90,ISTP:85,INFP:80,ENFP:75,INTP:75,ESFP:75,ISTJ:70,ESTJ:70,ISFJ:70,ESTP:65,INFJ:65,ENFJ:60,INTJ:55,ENTJ:55,ENTP:55,ESFJ:70},ISTP:{ESFJ:85,ESTJ:80,ISFJ:75,ISTJ:75,ESTP:75,ESFP:70,ISFP:70,ENTJ:65,ENTP:60,INTJ:60,INTP:60,ENFJ:55,INFJ:55,ENFP:55,INFP:50,ISTP:70},ISFP:{ENFJ:90,ESFJ:90,INFJ:85,ESTJ:80,ENTJ:75,ISTJ:75,ESFP:75,ISFJ:70,ESTP:70,ISTP:70,ENTP:65,INFP:65,ENFP:60,INTJ:55,INTP:50,ISFP:70},ESTP:{ISFJ:85,ISTJ:80,ESFJ:75,ESTJ:75,ISTP:75,ISFP:70,ESFP:70,ENTP:60,INTP:60,ENTJ:60,INTJ:55,INFP:55,ENFP:55,INFJ:55,ENFJ:50,ESTP:70},ESFP:{ISFJ:90,ISTJ:85,ESFJ:80,ENFJ:75,ESTJ:75,INFJ:75,ISFP:75,ESTP:70,ISTP:70,ENFP:65,INFP:65,ENTP:60,INTP:55,ENTJ:50,INTJ:50,ESFP:70}},d={INTJ:{name:"ì „ëµê°€",description:"ìƒìƒë ¥ì´ í’ë¶€í•˜ê³  ì „ëµì ì¸ ì‚¬ê³ ë¥¼ í•˜ëŠ” ê³„íšê°€"},INTP:{name:"ë…¼ë¦¬ìˆ ì‚¬",description:"í˜ì‹ ì ì¸ ì•„ì´ë””ì–´ë¥¼ ê°€ì§„ ì§€ì  íƒêµ¬ì"},ENTJ:{name:"í†µì†”ì",description:"ëŒ€ë‹´í•˜ê³  ìƒìƒë ¥ì´ í’ë¶€í•œ ê°•ë ¥í•œ ì§€ë„ì"},ENTP:{name:"ë³€ë¡ ê°€",description:"ì§€ì  ë„ì „ì„ ì¦ê¸°ëŠ” ì˜ë¦¬í•œ ì•…ë§ˆì˜ ëŒ€ë³€ì¸"},INFJ:{name:"ì˜¹í˜¸ì",description:"ì´ìƒì£¼ì˜ì ì´ê³  ì›ì¹™ì£¼ì˜ì ì¸ ì„ ì˜ì˜ í™œë™ê°€"},INFP:{name:"ì¤‘ì¬ì",description:"ì´íƒ€ì ì´ê³  í•­ìƒ ì„ í•œ ë™ê¸°ë¡œ í–‰ë™í•˜ëŠ” ì‚¬ëŒ"},ENFJ:{name:"ì„ ë„ì",description:"ì¹´ë¦¬ìŠ¤ë§ˆ ìˆê³  ì˜ê°ì„ ì£¼ëŠ” ì§€ë„ì"},ENFP:{name:"í™œë™ê°€",description:"ì—´ì •ì ì´ê³  ì°½ì˜ì ì¸ ììœ ë¡œìš´ ì˜í˜¼"},ISTJ:{name:"í˜„ì‹¤ì£¼ì˜ì",description:"ì‹¤ìš©ì ì´ê³  ì‚¬ì‹¤ì— ê¸°ë°˜í•œ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì‚¬ëŒ"},ISFJ:{name:"ìˆ˜í˜¸ì",description:"í—Œì‹ ì ì´ê³  ë”°ëœ»í•œ ìˆ˜í˜¸ì"},ESTJ:{name:"ê²½ì˜ì",description:"ì§ˆì„œë¥¼ ì¤‘ì‹œí•˜ëŠ” í›Œë¥­í•œ ê´€ë¦¬ì"},ESFJ:{name:"ì§‘ì •ê´€",description:"ë°°ë ¤ì‹¬ì´ ë§ê³  ì‚¬êµì ì¸ í˜‘ë ¥ì"},ISTP:{name:"ì¥ì¸",description:"ëŒ€ë‹´í•˜ê³  ì‹¤ìš©ì ì¸ íƒí—˜ê°€"},ISFP:{name:"ëª¨í—˜ê°€",description:"ìœ ì—°í•˜ê³  ë§¤ë ¥ì ì¸ ì˜ˆìˆ ê°€"},ESTP:{name:"ì‚¬ì—…ê°€",description:"ì˜ë¦¬í•˜ê³  ì—ë„ˆì§€ ë„˜ì¹˜ëŠ” ëª¨í—˜ì„ ì¦ê¸°ëŠ” ì‚¬ëŒ"},ESFP:{name:"ì—°ì˜ˆì¸",description:"ì¦‰í¥ì ì´ê³  ì—´ì •ì ì¸ ì¦ê±°ì›€ì„ ì¶”êµ¬í•˜ëŠ” ì‚¬ëŒ"}},m={excellent:{title:"í™˜ìƒì˜ ê¶í•©",emoji:"ğŸ’–",color:"#ec4899"},good:{title:"ì¢‹ì€ ê¶í•©",emoji:"ğŸ’•",color:"#f472b6"},average:{title:"í‰ë²”í•œ ê¶í•©",emoji:"ğŸ’›",color:"#fbbf24"},challenging:{title:"ë…¸ë ¥ì´ í•„ìš”í•œ ê¶í•©",emoji:"ğŸ’™",color:"#60a5fa"}};function x(e,s){const t=e.toUpperCase(),r=s.toUpperCase();if(!o[t]||!o[r])return{score:50,level:"average",title:"ì•Œ ìˆ˜ ì—†ëŠ” ê¶í•©",description:"MBTI ì •ë³´ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.",strengths:["ì„œë¡œë¥¼ ì•Œì•„ê°€ëŠ” ì‹œê°„ì´ í•„ìš”í•©ë‹ˆë‹¤"],challenges:["MBTIë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”"],advice:"MBTI ê²€ì‚¬ë¥¼ í†µí•´ ì •í™•í•œ ìœ í˜•ì„ í™•ì¸í•˜ì„¸ìš”."};const a=o[t][r]||50;let i;i=a>=85?"excellent":a>=70?"good":a>=55?"average":"challenging";const l=((e,s,t)=>{let r;r=t>=85?"excellent":t>=70?"good":t>=55?"average":"challenging";const a={excellent:{strengths:["ì„œë¡œì˜ ë‹¤ë¥¸ ì ì´ ì™„ë²½í•˜ê²Œ ë³´ì™„ë©ë‹ˆë‹¤","ê¹Šì€ ì´í•´ì™€ ê³µê°ëŒ€ë¥¼ í˜•ì„±í•©ë‹ˆë‹¤","í•¨ê»˜ ì„±ì¥í•˜ë©° ë°œì „í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤","ìì—°ìŠ¤ëŸ¬ìš´ ì¼€ë¯¸ìŠ¤íŠ¸ë¦¬ê°€ ìˆìŠµë‹ˆë‹¤"],challenges:["ë„ˆë¬´ ë¹„ìŠ·í•´ì„œ ê°€ë” ì§€ë£¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤","ì„œë¡œì˜ ì•½ì ì„ ë³´ì™„í•˜ëŠ” ë…¸ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤"],advice:"ì„œë¡œì˜ ì°¨ì´ë¥¼ ì¡´ì¤‘í•˜ë©°, í•¨ê»˜ ì„±ì¥í•˜ëŠ” ë° ì§‘ì¤‘í•˜ì„¸ìš”. í›Œë¥­í•œ íŒŒíŠ¸ë„ˆì‹­ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤!"},good:{strengths:["ì„œë¡œë¥¼ ì¡´ì¤‘í•˜ê³  ì´í•´í•©ë‹ˆë‹¤","ê±´ê°•í•œ ê´€ê³„ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤","ì„œë¡œì—ê²Œ ê¸ì •ì ì¸ ì˜í–¥ì„ ì¤ë‹ˆë‹¤"],challenges:["ê°€ì¹˜ê´€ ì°¨ì´ë¡œ ì¸í•œ ì˜ê²¬ ì¶©ëŒì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤","ì„œë¡œì˜ ì†Œí†µ ë°©ì‹ì„ ì´í•´í•˜ëŠ” ë…¸ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤","ë•Œë•Œë¡œ ì˜¤í•´ê°€ ìƒê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤"],advice:"ì—´ë¦° ë§ˆìŒìœ¼ë¡œ ì†Œí†µí•˜ê³ , ì„œë¡œì˜ ì°¨ì´ë¥¼ ì´í•´í•˜ë ¤ ë…¸ë ¥í•˜ì„¸ìš”. ì¢‹ì€ ê´€ê³„ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤."},average:{strengths:["ì„œë¡œì—ê²Œì„œ ìƒˆë¡œìš´ ê²ƒì„ ë°°ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤","ë‹¤ì–‘í•œ ê´€ì ì„ ë‚˜ëˆŒ ìˆ˜ ìˆìŠµë‹ˆë‹¤"],challenges:["ì„±ê²© ì°¨ì´ë¡œ ì¸í•œ ê°ˆë“±ì´ ìì£¼ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤","ì„œë¡œë¥¼ ì´í•´í•˜ëŠ” ë° ì‹œê°„ì´ í•„ìš”í•©ë‹ˆë‹¤","ì†Œí†µì— ë§ì€ ë…¸ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤","ê°€ì¹˜ê´€ ì°¨ì´ë¥¼ ì¡°ìœ¨í•´ì•¼ í•©ë‹ˆë‹¤"],advice:"ì¸ë‚´ì‹¬ì„ ê°€ì§€ê³  ì„œë¡œë¥¼ ì´í•´í•˜ë ¤ ë…¸ë ¥í•˜ì„¸ìš”. ì‹œê°„ê³¼ ë…¸ë ¥ì´ í•„ìš”í•˜ì§€ë§Œ ì¢‹ì€ ê´€ê³„ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤."},challenging:{strengths:["ì„œë¡œì—ê²Œ ìƒˆë¡œìš´ ì‹œê°ì„ ì œê³µí•©ë‹ˆë‹¤","ë‹¤ì–‘ì„±ì„ ê²½í—˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"],challenges:["ê·¼ë³¸ì ì¸ ê°€ì¹˜ê´€ ì°¨ì´ê°€ ìˆìŠµë‹ˆë‹¤","ì†Œí†µì´ ë§¤ìš° ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤","ì„œë¡œì˜ í–‰ë™ì„ ì´í•´í•˜ê¸° í˜ë“­ë‹ˆë‹¤","ë§ì€ íƒ€í˜‘ê³¼ ë…¸ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤","ê°ˆë“±ì´ ìì£¼ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"],advice:"ì„œë¡œì˜ ê·¼ë³¸ì ì¸ ì°¨ì´ë¥¼ ì¸ì •í•˜ê³ , ì¡´ì¤‘í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ê´€ê³„ ìœ ì§€ì— ìƒë‹¹í•œ ë…¸ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤."}}[r],i=d[e],l=d[s];return{title:m[r].title,description:`${i.name}(${e})ì™€ ${l.name}(${s})ì˜ ì¡°í•©ì…ë‹ˆë‹¤.`,strengths:a.strengths,challenges:a.challenges,advice:a.advice}})(t,r,a);return{score:a,level:i,...l}}function h(e){return m[e].color}function N(){const o=a(),d=i(),{user:N}=s(),u=d.state?.profile||d.state?.authorData,[g,b]=l.useState(0),[f,p]=l.useState(!1),[j,S]=l.useState(!1),[T,I]=l.useState(!1),[y,E]=l.useState(!1),[P,F]=l.useState(0),[J,v]=l.useState(0),[w,_]=l.useState(!1),[k,C]=l.useState(null),[q,$]=l.useState(null),M=50,z=(()=>{const e=localStorage.getItem("user");if(!e)return null;try{return JSON.parse(e).id}catch{return null}})(),B=z&&u?.id===z;l.useEffect(()=>{N||z||I(!0)},[N,z]),l.useEffect(()=>{(async()=>{if(!N?.id)return;const{data:s}=await e.from("users").select("coins, mbti").eq("id",N.id).single();s&&(F(s.coins||0),C(s.mbti||null))})()},[N?.id]);const U=n(u?.photos,u?.gender||""),X=()=>{v(e=>0===e?U.length-1:e-1)},D=()=>{v(e=>e===U.length-1?0:e+1)};if(!u)return o(-1),null;const O={school:u?.school||"ì •ë³´ì—†ìŒ",height:u?.height||"ì •ë³´ì—†ìŒ",bodyType:u?.bodyType||"ì •ë³´ì—†ìŒ",style:u?.style||"ì •ë³´ì—†ìŒ",religion:u?.religion||"ì •ë³´ì—†ìŒ",mbti:u?.mbti||"ESTP",smoking:u?.smoking||"ì •ë³´ì—†ìŒ",drinking:u?.drinking||"ì •ë³´ì—†ìŒ"},A=u?.interests||["ê´€ì‹¬ì‚¬"];return t.jsxs("div",{className:"min-h-screen bg-cyan-50 pb-24 "+(T?"overflow-hidden":""),children:[t.jsxs("div",{className:""+(T?"blur-sm pointer-events-none":""),children:[t.jsx("div",{className:"bg-white border-b sticky top-0 z-10",children:t.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[t.jsx("button",{onClick:()=>{o(-1)},className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors cursor-pointer",children:t.jsx("i",{className:"ri-arrow-left-s-line text-2xl"})}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("img",{src:U[0],alt:u.name,className:"w-8 h-8 rounded-full object-cover"}),t.jsx("span",{className:"font-medium text-gray-800",children:u.name})]}),t.jsx("button",{onClick:()=>{window.confirm("ì´ ì‚¬ìš©ìë¥¼ ì‹ ê³  ë˜ëŠ” ì°¨ë‹¨í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\ní™•ì¸: ì‹ ê³ í•˜ê¸°\nì·¨ì†Œ: ë‹«ê¸°")&&alert("ì‹ ê³  ê¸°ëŠ¥ ì¤€ë¹„ì¤‘ì…ë‹ˆë‹¤. ê³ ê°ì„¼í„°ë¡œ ë¬¸ì˜í•´ì£¼ì„¸ìš”.")},className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors cursor-pointer",children:t.jsx("i",{className:"ri-more-2-fill text-xl"})})]})}),t.jsx("div",{className:"relative bg-white",children:t.jsxs("div",{className:"relative w-full aspect-[3/4] bg-gray-100 overflow-hidden",onTouchStart:e=>{const s=e.touches[0];e.currentTarget.dataset.touchStartX=String(s.clientX)},onTouchEnd:e=>{const s=Number(e.currentTarget.dataset.touchStartX)-e.changedTouches[0].clientX;Math.abs(s)>50&&(s>0?D():X()),e.currentTarget.dataset.touchStartX=""},children:[t.jsx("img",{src:U[J],alt:`${u.name} ì‚¬ì§„ ${J+1}`,className:"w-full h-full object-cover"}),U.length>1&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:e=>{e.stopPropagation(),X()},className:"absolute left-3 top-1/2 -translate-y-1/2 w-10 h-10 bg-black/20 hover:bg-black/40 backdrop-blur-sm rounded-full flex items-center justify-center transition-all cursor-pointer active:scale-95",children:t.jsx("i",{className:"ri-arrow-left-s-line text-white text-2xl"})}),t.jsx("button",{onClick:e=>{e.stopPropagation(),D()},className:"absolute right-3 top-1/2 -translate-y-1/2 w-10 h-10 bg-black/20 hover:bg-black/40 backdrop-blur-sm rounded-full flex items-center justify-center transition-all cursor-pointer active:scale-95",children:t.jsx("i",{className:"ri-arrow-right-s-line text-white text-2xl"})})]}),U.length>1&&t.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 flex space-x-2 z-10",children:U.map((e,s)=>t.jsx("button",{onClick:e=>{e.stopPropagation(),v(s)},className:"w-2 h-2 rounded-full transition-all cursor-pointer shadow-sm "+(s===J?"bg-white w-4":"bg-white/50 hover:bg-white/80")},s))})]})}),t.jsxs("div",{className:"bg-white px-4 py-4 border-b",children:[t.jsx("div",{className:"flex items-center justify-center space-x-2",children:[1,2,3,4,5].map(e=>t.jsx("button",{onClick:()=>{return s=e,void(N?.id||z?b(s):I(!0));var s},className:"cursor-pointer",children:t.jsx("i",{className:"text-3xl "+(e<=g?"ri-star-fill text-yellow-400":"ri-star-line text-gray-300")})},e))}),t.jsx("p",{className:"text-center text-sm text-gray-500 mt-2",children:"í˜¸ê°ë„ë¥¼ ì²´í¬í•´ì£¼ì„¸ìš”"})]}),t.jsxs("div",{className:"px-4 py-6 space-y-4",children:[t.jsx("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:t.jsxs("div",{className:"grid grid-cols-2",children:[t.jsxs("div",{className:"border-b border-r border-gray-100 p-4",children:[t.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"í•™êµ"}),t.jsx("div",{className:"font-medium text-gray-800",children:O.school})]}),t.jsxs("div",{className:"border-b border-gray-100 p-4",children:[t.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"í‚¤"}),t.jsx("div",{className:"font-medium text-gray-800",children:O.height})]}),t.jsxs("div",{className:"border-b border-r border-gray-100 p-4",children:[t.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"ì²´í˜•"}),t.jsx("div",{className:"font-medium text-gray-800",children:O.bodyType})]}),t.jsxs("div",{className:"border-b border-gray-100 p-4",children:[t.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"ìŠ¤íƒ€ì¼"}),t.jsx("div",{className:"font-medium text-gray-800",children:O.style})]}),t.jsxs("div",{className:"border-b border-r border-gray-100 p-4",children:[t.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"ì¢…êµ"}),t.jsx("div",{className:"font-medium text-gray-800",children:O.religion})]}),t.jsxs("div",{className:"border-b border-gray-100 p-4",children:[t.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"MBTI"}),t.jsx("div",{className:"font-medium text-gray-800",children:O.mbti})]}),t.jsxs("div",{className:"border-r border-gray-100 p-4",children:[t.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"í¡ì—°"}),t.jsx("div",{className:"font-medium text-gray-800",children:O.smoking})]}),t.jsxs("div",{className:"p-4",children:[t.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"ìŒì£¼"}),t.jsx("div",{className:"font-medium text-gray-800",children:O.drinking})]})]})}),t.jsxs("button",{onClick:()=>{if(!k)return void alert("ë‚´ MBTI ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. í”„ë¡œí•„ì„ ì—…ë°ì´íŠ¸í•´ì£¼ì„¸ìš”.");if(!u?.mbti)return void alert("ìƒëŒ€ë°©ì˜ MBTI ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");const e=x(k,u.mbti);$(e),_(!0)},className:"w-full bg-gradient-to-r from-purple-500 to-pink-500 rounded-2xl p-4 shadow-lg flex items-center justify-between hover:shadow-xl transition-all cursor-pointer group",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center",children:t.jsx("span",{className:"text-2xl",children:"ğŸ’•"})}),t.jsxs("div",{className:"text-left",children:[t.jsx("span",{className:"font-bold text-white block",children:"MBTI ê¶í•© ë³´ê¸°"}),t.jsxs("span",{className:"text-white/80 text-sm",children:[k||"?"," & ",u?.mbti||"?"]})]})]}),t.jsx("i",{className:"ri-arrow-right-s-line text-2xl text-white/80 group-hover:translate-x-1 transition-transform"})]}),t.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[t.jsxs("h3",{className:"font-semibold text-gray-800 mb-4 flex items-center",children:[t.jsx("i",{className:"ri-heart-3-line mr-2 text-cyan-500"}),"ê´€ì‹¬ì‚¬"]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:A.map((e,s)=>t.jsx("span",{className:"bg-cyan-50 text-cyan-600 px-4 py-2 rounded-full text-sm font-medium",children:e},s))})]}),t.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[t.jsxs("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center",children:[t.jsx("i",{className:"ri-chat-quote-line mr-2 text-cyan-500"}),"ìê¸°ì†Œê°œ"]}),t.jsx("p",{className:"text-gray-700 leading-relaxed",children:u?.bio||"ìê¸°ì†Œê°œê°€ ì—†ìŠµë‹ˆë‹¤."})]})]}),!B&&t.jsxs("div",{className:"fixed bottom-0 left-0 right-0 bg-cyan-50 px-8 py-6 flex justify-center space-x-8",children:[t.jsx("button",{onClick:()=>{N?.id&&u?.id?E(!0):I(!0)},className:"w-16 h-16 bg-white rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-shadow cursor-pointer border-2 border-cyan-200",children:t.jsx("i",{className:"ri-heart-fill text-cyan-400 text-2xl"})}),t.jsx("button",{onClick:()=>{o(-1)},className:"w-16 h-16 bg-white rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-shadow cursor-pointer border-2 border-gray-200",children:t.jsx("i",{className:"ri-close-line text-gray-400 text-2xl"})})]})]}),f&&t.jsx("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-black/80 text-white px-6 py-4 rounded-2xl z-50",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("i",{className:"ri-heart-fill text-pink-400"}),t.jsxs("span",{children:[u.name,"ë‹˜ì—ê²Œ ì¢‹ì•„ìš”ë¥¼ ë³´ëƒˆì–´ìš”!"]})]})}),y&&t.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-white rounded-3xl p-6 max-w-sm w-full text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-cyan-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx("i",{className:"ri-magnet-line text-white text-2xl"})}),t.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"í•˜íŠ¸ë¥¼ ë³´ë‚´ì‹œê² ì–´ìš”?"}),t.jsxs("p",{className:"text-gray-600 mb-2",children:[t.jsx("span",{className:"font-bold text-cyan-600",children:u.name}),"ë‹˜ì—ê²Œ",t.jsx("br",{}),"í•˜íŠ¸ë¥¼ ë³´ë‚´ë ¤ë©´ ìì„ ",t.jsxs("span",{className:"font-bold text-cyan-600",children:[M,"ê°œ"]}),"ê°€ ì†Œëª¨ë©ë‹ˆë‹¤."]}),t.jsx("div",{className:"bg-cyan-50 rounded-xl p-3 mb-4",children:t.jsxs("p",{className:"text-sm text-cyan-700",children:[t.jsx("i",{className:"ri-information-line mr-1"}),"ìƒëŒ€ê°€ ê±°ì ˆí•˜ë©´ ìì„ì´ í™˜ë¶ˆë©ë‹ˆë‹¤"]})}),t.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["ë³´ìœ  ìì„: ",t.jsxs("span",{className:"font-bold",children:[P,"ê°œ"]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("button",{onClick:async()=>{E(!1);try{if(!N?.id||!u?.id)return void I(!0);if(P<M)return alert(`ìì„ì´ ë¶€ì¡±í•©ë‹ˆë‹¤. í˜„ì¬ ${P}ê°œ ë³´ìœ  ì¤‘`),void o("/coin-shop");const s=String(N.id),t=String(u.id);r.info("ë§¤ì¹­ ìš”ì²­ ì •ë³´",{fromUserId:s,toUserId:t});const{data:a}=await e.from("matching_requests").select("id").eq("from_user_id",t).eq("to_user_id",s).eq("status","pending").limit(1),i=a&&a.length>0;r.info("ìƒí˜¸ ë§¤ì¹­ ì—¬ë¶€",{isMutualMatch:i});const{data:l}=await e.from("matching_requests").select("id").eq("from_user_id",s).eq("to_user_id",t).limit(1);if(l&&l.length>0)return void alert("ì´ë¯¸ ë§¤ì¹­ ìš”ì²­ì„ ë³´ë‚¸ ìƒëŒ€ì…ë‹ˆë‹¤");const{error:n}=await e.from("users").update({coins:P-M}).eq("id",N.id);if(n)return r.error("ì½”ì¸ ì°¨ê° ì‹¤íŒ¨",n),void alert("ìì„ ì°¨ê°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");F(e=>e-M);const{data:d,error:m}=await e.from("matching_requests").insert({from_user_id:s,to_user_id:t,status:i?"accepted":"pending"}).select();if(r.info("ë§¤ì¹­ ìš”ì²­ ê²°ê³¼",{data:d,error:m}),m){if("23505"===m.code)return void alert("ì´ë¯¸ ë§¤ì¹­ ìš”ì²­ì„ ë³´ë‚¸ ìƒëŒ€ì…ë‹ˆë‹¤");throw m}if(i){await e.from("matching_requests").update({status:"accepted"}).eq("from_user_id",t).eq("to_user_id",s);const{data:a,error:i}=await e.from("chat_rooms").insert({user1_id:s,user2_id:t,created_at:(new Date).toISOString()}).select().single();i?r.error("ì±„íŒ…ë°© ìƒì„± ì‹¤íŒ¨",i):r.info("ì±„íŒ…ë°© ìƒì„± ì™„ë£Œ",{chatRoom:a}),await e.from("notifications").insert([{user_id:t,type:"match_success",title:"ë§¤ì¹­ ì„±ì‚¬! ğŸ’•",message:`${N.name||"ëˆ„êµ°ê°€"}ë‹˜ê³¼ ë§¤ì¹­ë˜ì—ˆìŠµë‹ˆë‹¤! ëŒ€í™”ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”.`,data:{matched_user_id:s,chat_room_id:a?.id},read:!1},{user_id:s,type:"match_success",title:"ë§¤ì¹­ ì„±ì‚¬! ğŸ’•",message:`${u.name}ë‹˜ê³¼ ë§¤ì¹­ë˜ì—ˆìŠµë‹ˆë‹¤! ëŒ€í™”ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”.`,data:{matched_user_id:t,chat_room_id:a?.id},read:!1}]),await(async(e,s,t)=>c(e,{title:"ğŸ‰ ë§¤ì¹­ ì„±ì‚¬!",body:`${s}ë‹˜ê³¼ ë§¤ì¹­ë˜ì—ˆìŠµë‹ˆë‹¤! ëŒ€í™”ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”.`,data:{type:"match_success",chat_room_id:t||""}}))(t,N.name||"ëˆ„êµ°ê°€",a?.id),S(!0)}else await e.from("notifications").insert({user_id:t,type:"match_request",title:"ìƒˆë¡œìš´ ë§¤ì¹­ ìš”ì²­",message:`${N.name||"ëˆ„êµ°ê°€"}ë‹˜ì´ ë§¤ì¹­ì„ ìš”ì²­í–ˆìŠµë‹ˆë‹¤`,data:{from_user_id:s,from_user_name:N.name},read:!1}),await(async(e,s,t)=>c(e,{title:"ğŸ’• ìƒˆë¡œìš´ ë§¤ì¹­ ìš”ì²­",body:`${s}ë‹˜ì´ ë§¤ì¹­ì„ ìš”ì²­í–ˆìŠµë‹ˆë‹¤`,data:{type:"match_request",from_user_id:t}}))(t,N.name||"ëˆ„êµ°ê°€",s),p(!0),setTimeout(()=>{p(!1),o(-1)},2e3)}catch(s){r.error("ë§¤ì¹­ ìš”ì²­ ì‹¤íŒ¨",s),alert("ë§¤ì¹­ ìš”ì²­ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: "+(s?.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"))}},disabled:P<M,className:"w-full bg-gradient-to-r from-cyan-500 to-blue-600 text-white py-3 rounded-full font-medium hover:from-cyan-600 hover:to-blue-700 transition-all cursor-pointer whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed",children:P<M?"ìì„ ë¶€ì¡±":"í™•ì¸"}),t.jsx("button",{onClick:()=>E(!1),className:"w-full bg-gray-100 text-gray-600 py-3 rounded-full font-medium hover:bg-gray-200 transition-colors cursor-pointer whitespace-nowrap",children:"ì·¨ì†Œ"})]})]})}),j&&t.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-white rounded-3xl p-6 max-w-sm w-full text-center",children:[t.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-cyan-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx("i",{className:"ri-heart-fill text-white text-3xl"})}),t.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"ë§¤ì¹­ ì„±ê³µ! ğŸ‰"}),t.jsxs("p",{className:"text-gray-600 mb-6",children:[u.name,"ë‹˜ê³¼ ì„œë¡œ ì¢‹ì•„ìš”ë¥¼ ëˆŒë €ì–´ìš”!",t.jsx("br",{}),"ì§€ê¸ˆ ë°”ë¡œ ëŒ€í™”ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”."]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("button",{onClick:()=>{S(!1);const e=new CustomEvent("openChat",{detail:{userId:u.id,userName:u.name,userAvatar:U[0]||""}});window.dispatchEvent(e),o("/")},className:"w-full bg-gradient-to-r from-cyan-500 to-blue-600 text-white py-3 rounded-full font-medium hover:from-cyan-600 hover:to-blue-700 transition-all cursor-pointer whitespace-nowrap",children:"ëŒ€í™” ì‹œì‘í•˜ê¸°"}),t.jsx("button",{onClick:()=>S(!1),className:"w-full bg-gray-100 text-gray-600 py-3 rounded-full font-medium hover:bg-gray-200 transition-colors cursor-pointer whitespace-nowrap",children:"ë‚˜ì¤‘ì—"})]})]})}),T&&t.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[t.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-md"}),t.jsxs("div",{className:"relative bg-white rounded-3xl p-8 max-w-sm w-full mx-4 text-center shadow-2xl",children:[t.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-cyan-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx("i",{className:"ri-lock-line text-white text-3xl"})}),t.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-3",children:"ë¡œê·¸ì¸ í›„ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤"}),t.jsxs("p",{className:"text-gray-600 mb-6",children:["í”„ë¡œí•„ ìƒì„¸ ì •ë³´ë¥¼ ë³´ë ¤ë©´",t.jsx("br",{}),"ë¡œê·¸ì¸ì´ í•„ìš”í•´ìš”"]}),t.jsx("button",{onClick:()=>o("/login"),className:"w-full bg-gradient-to-r from-cyan-500 to-blue-600 text-white py-4 rounded-full font-bold hover:from-cyan-600 hover:to-blue-700 transition-all shadow-lg cursor-pointer whitespace-nowrap",children:"ë‹«ê¸°"})]})]}),w&&q&&t.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-white rounded-3xl p-6 max-w-sm w-full max-h-[80vh] overflow-y-auto",children:[t.jsxs("div",{className:"text-center mb-6",children:[t.jsx("div",{className:"text-5xl mb-3",children:(R=q.level,m[R].emoji)}),t.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-1",children:q.title}),t.jsxs("div",{className:"flex items-center justify-center gap-2 text-lg",children:[t.jsx("span",{className:"bg-purple-100 text-purple-600 px-3 py-1 rounded-full font-bold",children:k}),t.jsx("span",{className:"text-gray-400",children:"Ã—"}),t.jsx("span",{className:"bg-pink-100 text-pink-600 px-3 py-1 rounded-full font-bold",children:u?.mbti})]})]}),t.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-2xl p-4 mb-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-gray-600 font-medium",children:"ê¶í•© ì ìˆ˜"}),t.jsxs("span",{className:"text-2xl font-bold",style:{color:h(q.level)},children:[q.score,"ì "]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:t.jsx("div",{className:"h-3 rounded-full transition-all duration-500",style:{width:`${q.score}%`,backgroundColor:h(q.level)}})})]}),t.jsx("p",{className:"text-gray-600 text-sm mb-4 bg-gray-50 p-3 rounded-xl",children:q.description}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("h4",{className:"font-bold text-gray-800 mb-2 flex items-center",children:[t.jsx("span",{className:"text-green-500 mr-2",children:"ğŸ’š"})," ì´ëŸ° ì ì´ ì¢‹ì•„ìš”"]}),t.jsx("ul",{className:"space-y-1",children:q.strengths.slice(0,3).map((e,s)=>t.jsxs("li",{className:"text-sm text-gray-600 flex items-start",children:[t.jsx("i",{className:"ri-check-line text-green-500 mr-2 mt-0.5"}),e]},s))})]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("h4",{className:"font-bold text-gray-800 mb-2 flex items-center",children:[t.jsx("span",{className:"text-amber-500 mr-2",children:"ğŸ’›"})," ì´ëŸ° ì ì€ ì¡°ì‹¬í•´ìš”"]}),t.jsx("ul",{className:"space-y-1",children:q.challenges.slice(0,2).map((e,s)=>t.jsxs("li",{className:"text-sm text-gray-600 flex items-start",children:[t.jsx("i",{className:"ri-alert-line text-amber-500 mr-2 mt-0.5"}),e]},s))})]}),t.jsxs("div",{className:"bg-gradient-to-r from-purple-100 to-pink-100 rounded-2xl p-4 mb-4",children:[t.jsxs("h4",{className:"font-bold text-gray-800 mb-1 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ğŸ’¡"})," ì—°ì•  ê¿€íŒ"]}),t.jsx("p",{className:"text-sm text-gray-700",children:q.advice})]}),t.jsx("button",{onClick:()=>_(!1),className:"w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white py-3 rounded-full font-bold hover:from-purple-600 hover:to-pink-600 transition-all cursor-pointer",children:"í™•ì¸"})]})})]});var R}export{N as default};
